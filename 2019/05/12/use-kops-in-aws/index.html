<!DOCTYPE html>
<html lang="zh-cn" >
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>

  
  <meta name="author"
        content="vsxen"/>

  
  <meta name="description" content="简介：Kubernetes Operations (kops) - Production Grade K8s Installation, Upgrades, and Management kops宣称已经达到生产级别，准备试一下kops，观察其运行控制平面的方式。官方的文档如下： https://github.com/kubernetes/kops/blob/master/docs/aws.md 安装 当然kops也是用golang写的，所以你只要下载预编译"/>
  

  
  
  <meta name="keywords" content="blog, k8s, devops"/>
  

  
  <link rel="canonical" href="https://vsxen.github.io/2019/05/12/use-kops-in-aws/"/>

  

  <title>在aws上使用kops部署k8s集群 &middot; Code Life</title>

  <link rel="shortcut icon" href="https://vsxen.github.io/images/favicon.ico"/>
  <link rel="stylesheet" href="https://vsxen.github.io/css/animate.min.css"/>
  <link rel="stylesheet" href="https://vsxen.github.io/css/remixicon.css"/>
  <link rel="stylesheet" href="https://vsxen.github.io/css/zozo.css"/>
  <link rel="stylesheet" href="https://vsxen.github.io/css/highlight.css"/>

  
  

  <script>
    (function(d) {
      var config = {
        kitId: 'kfn1kkp',
        scriptTimeout: 3000,
        async: true
      },
      h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
    })(document);
  </script>
</head>

<body>
<div class="main animated">
  <div class="nav_container animated fadeInDown">
  <div class="site_nav" id="site_nav">
    <ul>
      
      <li>
        <a href="/">首页</a>
      </li>
      
      <li>
        <a href="/posts/">归档</a>
      </li>
      
      <li>
        <a href="/tags/">标签</a>
      </li>
      
      <li>
        <a href="/about/">关于</a>
      </li>
      
    </ul>
  </div>
  <div class="menu_icon">
    <a id="menu_icon"><i class="remixicon-links-line"></i></a>
  </div>
</div>

  <div class="header animated fadeInDown">
  <div class="site_title_container">
    <div class="site_title">
      <h1>
        <a href="https://vsxen.github.io">
          <span>Code Life</span>
          <img src="https://vsxen.github.io/images/logo.svg"/>
        </a>
      </h1>
    </div>
    <div class="description">
      <p class="sub_title">Life is too bug</p>
      <div class="my_socials">
        
        
        <a href="%20" title="facebook" target="_blank"><i class="remixicon-facebook-fill"></i></a>
        
        
        
        <a href="%20" title="github" target="_blank"><i class="remixicon-github-fill"></i></a>
        
        
        
        <a href="%20" title="instagram" target="_blank"><i class="remixicon-instagram-fill"></i></a>
        
        
        
        <a href="%20" title="twitter" target="_blank"><i class="remixicon-twitter-fill"></i></a>
        
        
        
        <a href="%20" title="weibo" target="_blank"><i class="remixicon-weibo-fill"></i></a>
        
        
        <a href="https://vsxen.github.io/index.xml" type="application/rss+xml" title="rss" target="_blank"><i class="remixicon-rss-fill"></i></a>
      </div>
    </div>
  </div>
</div>

  <div class="content">
    <div class="post_page">
      <div class="post animated fadeInDown">
        <div class="post_title post_detail_title">
          <h2><a href='/2019/05/12/use-kops-in-aws/'>在aws上使用kops部署k8s集群</a></h2>
          <span class="date">2019.05.12</span>
        </div>
        <div class="post_content markdown"><p>简介：Kubernetes Operations (kops) - Production Grade K8s Installation, Upgrades, and Management
kops宣称已经达到生产级别，准备试一下kops，观察其运行控制平面的方式。官方的文档如下：
<a href="https://github.com/kubernetes/kops/blob/master/docs/aws.md">https://github.com/kubernetes/kops/blob/master/docs/aws.md</a></p>
<h2 id="安装">安装</h2>
<p>当然kops也是用golang写的，所以你只要下载预编译的二进制文件即可。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># 指定版本</span>
https://github.com/kubernetes/kops/releases/download/1.10.0/kops-linux-amd64

<span style="color:#75715e">#最新版本</span>
wget -O kops https://github.com/kubernetes/kops/releases/download/<span style="color:#66d9ef">$(</span>curl -s https://api.github.com/repos/kubernetes/kops/releases/latest | grep tag_name | cut -d <span style="color:#e6db74">&#39;&#34;&#39;</span> -f 4<span style="color:#66d9ef">)</span>/kops-linux-amd64
chmod +x ./kops
sudo mv ./kops /usr/local/bin/

curl -LO https://storage.googleapis.com/kubernetes-release/release/1.10.0/bin/linux/amd64/kubectl

wget -O kubectl https://storage.googleapis.com/kubernetes-release/release/<span style="color:#66d9ef">$(</span>curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt<span style="color:#66d9ef">)</span>/bin/linux/amd64/kubectl
chmod +x ./kubectl
sudo mv ./kubectl /usr/local/bin/kubectl

<span style="color:#75715e">#awscli是用Python写的，安装Python和pip后直接运行下面命令就可以了。</span>
pip install awscli
</code></pre></div><h2 id="创建iam">创建IAM</h2>
<p>kops 需要有以下四个权限，首先创建了kops的用户组，然后创建了kops用户</p>
<ul>
<li>AmazonEC2FullAccess</li>
<li>AmazonRoute53FullAccess</li>
<li>AmazonS3FullAccess</li>
<li>IAMFullAccess</li>
<li>AmazonVPCFullAccess</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">aws iam create-group --group-name kops

aws iam attach-group-policy --policy-arn arn:aws:iam::aws:policy/AmazonEC2FullAccess --group-name kops
aws iam attach-group-policy --policy-arn arn:aws:iam::aws:policy/AmazonRoute53FullAccess --group-name kops
aws iam attach-group-policy --policy-arn arn:aws:iam::aws:policy/AmazonS3FullAccess --group-name kops
aws iam attach-group-policy --policy-arn arn:aws:iam::aws:policy/IAMFullAccess --group-name kops
aws iam attach-group-policy --policy-arn arn:aws:iam::aws:policy/AmazonVPCFullAccess --group-name kops

aws iam create-user --user-name kops

aws iam add-user-to-group --user-name kops --group-name kops

aws iam create-access-key --user-name kops

<span style="color:#75715e"># configure the aws client to use your new IAM user</span>
aws configure           <span style="color:#75715e"># Use your new access and secret key here</span>
aws iam list-users      <span style="color:#75715e"># you should see a list of all your IAM users here</span>

<span style="color:#75715e"># Because &#34;aws configure&#34; doesn&#39;t export these vars for kops to use, we export them now</span>
export AWS_ACCESS_KEY_ID<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>aws configure get aws_access_key_id<span style="color:#66d9ef">)</span>
export AWS_SECRET_ACCESS_KEY<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>aws configure get aws_secret_access_key<span style="color:#66d9ef">)</span>
</code></pre></div><h2 id="创建s3">创建S3</h2>
<p>首先我创建了一个s3的存储，用于存放kops的配置文件，然后为这个存储桶加入了版本控制</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">aws s3api create-bucket <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --bucket k8s-lc-demo <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --region ap-southeast-1
    
aws s3api put-bucket-versioning --bucket k8s-lc-demo --versioning-configuration Status<span style="color:#f92672">=</span>Enabled
</code></pre></div><h2 id="创建集群">创建集群</h2>
<p>首先需要配置一下kops在S3上的存储路径，然后我指定了集群在三个可用区，一个VPC,三个子网
网络方案采用calico（默认是kubenet），一个Node，一个master。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">export KOPS_STATE_STORE<span style="color:#f92672">=</span>s3://k8s-lc-demo

export NAME<span style="color:#f92672">=</span>vsxen.k8s.local

kops create cluster --name<span style="color:#f92672">=</span><span style="color:#e6db74">${</span>NAME<span style="color:#e6db74">}</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--zones<span style="color:#f92672">=</span>ap-southeast-1a,ap-southeast-1b,ap-southeast-1c <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--vpc<span style="color:#f92672">=</span>vpc-0d594dbc069d8feef <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--subnets<span style="color:#f92672">=</span>subnet-0eae91c9b2ff47237,subnet-0698d31499240ac10,subnet-0f104beb16bd44abf <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--node-count<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> --networking<span style="color:#f92672">=</span>calico --master-count<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>

kops update cluster <span style="color:#e6db74">${</span>NAME<span style="color:#e6db74">}</span> --yes

kops delete cluster <span style="color:#e6db74">${</span>NAME<span style="color:#e6db74">}</span> --yes

看看别的参数

Flags:
      --admin-access strings             Restrict API access to this CIDR.  If not set, access will not be restricted by IP. <span style="color:#f92672">(</span>default <span style="color:#f92672">[</span>0.0.0.0/0<span style="color:#f92672">])</span>
      --api-loadbalancer-type string     Sets the API loadbalancer type to either <span style="color:#e6db74">&#39;public&#39;</span> or <span style="color:#e6db74">&#39;internal&#39;</span>
      --api-ssl-certificate string       Currently only supported in AWS. Sets the ARN of the SSL Certificate to use <span style="color:#66d9ef">for</span> the API server loadbalancer.
      --associate-public-ip              Specify --associate-public-ip<span style="color:#f92672">=[</span>true|false<span style="color:#f92672">]</span> to enable/disable association of public IP <span style="color:#66d9ef">for</span> master ASG and nodes. Default is <span style="color:#e6db74">&#39;true&#39;</span>.
      --authorization string             Authorization mode to use: AlwaysAllow or RBAC <span style="color:#f92672">(</span>default <span style="color:#e6db74">&#34;RBAC&#34;</span><span style="color:#f92672">)</span>
      --bastion                          Pass the --bastion flag to enable a bastion instance group. Only applies to private topology.
      --channel string                   Channel <span style="color:#66d9ef">for</span> default versions and configuration to use <span style="color:#f92672">(</span>default <span style="color:#e6db74">&#34;stable&#34;</span><span style="color:#f92672">)</span>
      --cloud string                     Cloud provider to use - gce, aws, vsphere
      --cloud-labels string              A list of KV pairs used to tag all instance groups in AWS <span style="color:#f92672">(</span>eg <span style="color:#e6db74">&#34;Owner=John Doe,Team=Some Team&#34;</span><span style="color:#f92672">)</span>.
      --dns string                       DNS hosted zone to use: public|private. Default is <span style="color:#e6db74">&#39;public&#39;</span>. <span style="color:#f92672">(</span>default <span style="color:#e6db74">&#34;Public&#34;</span><span style="color:#f92672">)</span>
      --dns-zone string                  DNS hosted zone to use <span style="color:#f92672">(</span>defaults to longest matching zone<span style="color:#f92672">)</span>
      --dry-run                          If true, only print the object that would be sent, without sending it. This flag can be used to create a cluster YAML or JSON manifest.
      --encrypt-etcd-storage             Generate key in aws kms and use it <span style="color:#66d9ef">for</span> encrypt etcd volumes
  -h, --help                             help <span style="color:#66d9ef">for</span> cluster
      --image string                     Image to use <span style="color:#66d9ef">for</span> all instances.
      --kubernetes-version string        Version of kubernetes to run <span style="color:#f92672">(</span>defaults to version in channel<span style="color:#f92672">)</span>
      --master-count int32               Set the number of masters.  Defaults to one master per master-zone
      --master-public-name string        Sets the public master public name
      --master-security-groups strings   Add precreated additional security groups to masters.
      --master-size string               Set instance size <span style="color:#66d9ef">for</span> masters
      --master-tenancy string            The tenancy of the master group on AWS. Can either be default or dedicated.
      --master-volume-size int32         Set instance volume size <span style="color:#f92672">(</span>in GB<span style="color:#f92672">)</span> <span style="color:#66d9ef">for</span> masters
      --master-zones strings             Zones in which to run masters <span style="color:#f92672">(</span>must be an odd number<span style="color:#f92672">)</span>
      --model string                     Models to apply <span style="color:#f92672">(</span>separate multiple models with commas<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>default <span style="color:#e6db74">&#34;proto,cloudup&#34;</span><span style="color:#f92672">)</span>
      --network-cidr string              Set to override the default network CIDR
      --networking string                Networking mode to use.  kubenet <span style="color:#f92672">(</span>default<span style="color:#f92672">)</span>, classic, external, kopeio-vxlan <span style="color:#f92672">(</span>or kopeio<span style="color:#f92672">)</span>, weave, flannel-vxlan <span style="color:#f92672">(</span>or flannel<span style="color:#f92672">)</span>, flannel-udp, calico, canal, kube-router, romana, amazon-vpc-routed-eni, cilium. <span style="color:#f92672">(</span>default <span style="color:#e6db74">&#34;kubenet&#34;</span><span style="color:#f92672">)</span>
      --node-count int32                 Set the number of nodes
      --node-security-groups strings     Add precreated additional security groups to nodes.
      --node-size string                 Set instance size <span style="color:#66d9ef">for</span> nodes
      --node-tenancy string              The tenancy of the node group on AWS. Can be either default or dedicated.
      --node-volume-size int32           Set instance volume size <span style="color:#f92672">(</span>in GB<span style="color:#f92672">)</span> <span style="color:#66d9ef">for</span> nodes
      --out string                       Path to write any local output
  -o, --output string                    Output format. One of json|yaml. Used with the --dry-run flag.
      --project string                   Project to use <span style="color:#f92672">(</span>must be set on GCE<span style="color:#f92672">)</span>
      --ssh-access strings               Restrict SSH access to this CIDR.  If not set, access will not be restricted by IP. <span style="color:#f92672">(</span>default <span style="color:#f92672">[</span>0.0.0.0/0<span style="color:#f92672">])</span>
      --ssh-public-key string            SSH public key to use <span style="color:#f92672">(</span>defaults to ~/.ssh/id_rsa.pub on AWS<span style="color:#f92672">)</span>
      --subnets strings                  Set to use shared subnets
      --target string                    Valid targets: direct, terraform, cloudformation. Set this flag to terraform <span style="color:#66d9ef">if</span> you want kops to generate terraform <span style="color:#f92672">(</span>default <span style="color:#e6db74">&#34;direct&#34;</span><span style="color:#f92672">)</span>
  -t, --topology string                  Controls network topology <span style="color:#66d9ef">for</span> the cluster. public|private. Default is <span style="color:#e6db74">&#39;public&#39;</span>. <span style="color:#f92672">(</span>default <span style="color:#e6db74">&#34;public&#34;</span><span style="color:#f92672">)</span>
      --utility-subnets strings          Set to use shared utility subnets
      --vpc string                       Set to use a shared VPC
  -y, --yes                              Specify --yes to immediately create the cluster
      --zones strings                    Zones in which to run the cluster

</code></pre></div><h2 id="集群信息查看">集群信息查看</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl -n kube-system get all
NAME                                                                           READY     STATUS    RESTARTS   AGE
pod/dns-controller-6d6b7f78b-d59r9                                             1/1       Running   <span style="color:#ae81ff">0</span>          6m
pod/etcd-server-events-ip-192-168-0-154.ap-southeast-1.compute.internal        1/1       Running   <span style="color:#ae81ff">0</span>          6m
pod/etcd-server-events-ip-192-168-1-157.ap-southeast-1.compute.internal        1/1       Running   <span style="color:#ae81ff">0</span>          5m
pod/etcd-server-events-ip-192-168-2-21.ap-southeast-1.compute.internal         1/1       Running   <span style="color:#ae81ff">0</span>          6m
pod/etcd-server-ip-192-168-0-154.ap-southeast-1.compute.internal               1/1       Running   <span style="color:#ae81ff">0</span>          6m
pod/etcd-server-ip-192-168-1-157.ap-southeast-1.compute.internal               1/1       Running   <span style="color:#ae81ff">0</span>          5m
pod/etcd-server-ip-192-168-2-21.ap-southeast-1.compute.internal                1/1       Running   <span style="color:#ae81ff">0</span>          6m
pod/kube-apiserver-ip-192-168-0-154.ap-southeast-1.compute.internal            1/1       Running   <span style="color:#ae81ff">0</span>          6m
pod/kube-apiserver-ip-192-168-1-157.ap-southeast-1.compute.internal            1/1       Running   <span style="color:#ae81ff">0</span>          5m
pod/kube-apiserver-ip-192-168-2-21.ap-southeast-1.compute.internal             1/1       Running   <span style="color:#ae81ff">0</span>          6m
pod/kube-controller-manager-ip-192-168-0-154.ap-southeast-1.compute.internal   1/1       Running   <span style="color:#ae81ff">0</span>          5m
pod/kube-controller-manager-ip-192-168-1-157.ap-southeast-1.compute.internal   1/1       Running   <span style="color:#ae81ff">0</span>          5m
pod/kube-controller-manager-ip-192-168-2-21.ap-southeast-1.compute.internal    1/1       Running   <span style="color:#ae81ff">0</span>          6m
pod/kube-dns-5fbcb4d67b-784mb                                                  3/3       Running   <span style="color:#ae81ff">0</span>          4m
pod/kube-dns-5fbcb4d67b-zwvs6                                                  3/3       Running   <span style="color:#ae81ff">0</span>          6m
pod/kube-dns-autoscaler-6874c546dd-gmdqj                                       1/1       Running   <span style="color:#ae81ff">0</span>          6m
pod/kube-proxy-ip-192-168-0-154.ap-southeast-1.compute.internal                1/1       Running   <span style="color:#ae81ff">0</span>          5m
pod/kube-proxy-ip-192-168-1-157.ap-southeast-1.compute.internal                1/1       Running   <span style="color:#ae81ff">0</span>          6m
pod/kube-proxy-ip-192-168-1-77.ap-southeast-1.compute.internal                 1/1       Running   <span style="color:#ae81ff">0</span>          4m
pod/kube-proxy-ip-192-168-2-21.ap-southeast-1.compute.internal                 1/1       Running   <span style="color:#ae81ff">0</span>          6m
pod/kube-proxy-ip-192-168-2-84.ap-southeast-1.compute.internal                 1/1       Running   <span style="color:#ae81ff">0</span>          5m
pod/kube-scheduler-ip-192-168-0-154.ap-southeast-1.compute.internal            1/1       Running   <span style="color:#ae81ff">0</span>          6m
pod/kube-scheduler-ip-192-168-1-157.ap-southeast-1.compute.internal            1/1       Running   <span style="color:#ae81ff">0</span>          5m
pod/kube-scheduler-ip-192-168-2-21.ap-southeast-1.compute.internal             1/1       Running   <span style="color:#ae81ff">0</span>          6m

NAME               TYPE        CLUSTER-IP    EXTERNAL-IP   PORT<span style="color:#f92672">(</span>S<span style="color:#f92672">)</span>         AGE
service/kube-dns   ClusterIP   100.64.0.10   &lt;none&gt;        53/UDP,53/TCP   6m

NAME                                  DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/dns-controller        <span style="color:#ae81ff">1</span>         <span style="color:#ae81ff">1</span>         <span style="color:#ae81ff">1</span>            <span style="color:#ae81ff">1</span>           7m
deployment.apps/kube-dns              <span style="color:#ae81ff">2</span>         <span style="color:#ae81ff">2</span>         <span style="color:#ae81ff">2</span>            <span style="color:#ae81ff">2</span>           6m
deployment.apps/kube-dns-autoscaler   <span style="color:#ae81ff">1</span>         <span style="color:#ae81ff">1</span>         <span style="color:#ae81ff">1</span>            <span style="color:#ae81ff">1</span>           6m

NAME                                             DESIRED   CURRENT   READY     AGE
replicaset.apps/dns-controller-6d6b7f78b         <span style="color:#ae81ff">1</span>         <span style="color:#ae81ff">1</span>         <span style="color:#ae81ff">1</span>         7m
replicaset.apps/kube-dns-5fbcb4d67b              <span style="color:#ae81ff">2</span>         <span style="color:#ae81ff">2</span>         <span style="color:#ae81ff">2</span>         6m
replicaset.apps/kube-dns-autoscaler-6874c546dd   <span style="color:#ae81ff">1</span>         <span style="color:#ae81ff">1</span>         <span style="color:#ae81ff">1</span>         6m
</code></pre></div><h3 id="master">Master</h3>
<p>所有的Docker镜像,看得出和kubeadm启动方式一样</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">protokube                            1.10.0              757f84ea7739        <span style="color:#ae81ff">2</span> days ago          <span style="color:#ae81ff">278</span> MB
kope/dns-controller                  1.10.0              082d4c9dd8fe        <span style="color:#ae81ff">3</span> days ago          <span style="color:#ae81ff">119</span> MB
k8s.gcr.io/kube-proxy                v1.10.3             4261d315109d        <span style="color:#ae81ff">2</span> months ago        97.1 MB
k8s.gcr.io/kube-apiserver            v1.10.3             e03746fe22c3        <span style="color:#ae81ff">2</span> months ago        <span style="color:#ae81ff">225</span> MB
k8s.gcr.io/kube-controller-manager   v1.10.3             40c8d10b2d11        <span style="color:#ae81ff">2</span> months ago        <span style="color:#ae81ff">148</span> MB
k8s.gcr.io/kube-scheduler            v1.10.3             353b8f1d102e        <span style="color:#ae81ff">2</span> months ago        50.4 MB
quay.io/calico/node                  v2.6.7              7c694b9cac81        <span style="color:#ae81ff">6</span> months ago        <span style="color:#ae81ff">282</span> MB
quay.io/calico/kube-controllers      v1.0.3              34aebe64326d        <span style="color:#ae81ff">7</span> months ago        52.2 MB
quay.io/calico/cni                   v1.11.2             6f0a76fc7dd2        <span style="color:#ae81ff">8</span> months ago        70.8 MB
k8s.gcr.io/pause-amd64               3.0                 99e59f495ffa        <span style="color:#ae81ff">2</span> years ago         <span style="color:#ae81ff">747</span> kB
k8s.gcr.io/etcd                      2.2.1               ef5842ca5c42        <span style="color:#ae81ff">2</span> years ago         28.2 MB
</code></pre></div><h4 id="证书文件">证书文件</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">/srv/kubernetes/
apiserver-aggregator-ca.cert  apiserver-aggregator.key  basic_auth.csv  ca.key            proxy-client.cert  server.cert
apiserver-aggregator.cert     assets                    ca.crt          known_tokens.csv  proxy-client.key   server.key
</code></pre></div><h4 id="kubelet启动参数">kubelet启动参数</h4>
<p>这里并没有像kubeadm那样配置另外的参数</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat /etc/sysconfig/kubelet
DAEMON_ARGS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--allow-privileged=true  \ 
</span><span style="color:#e6db74">--cgroup-root=/  \ 
</span><span style="color:#e6db74">--cloud-provider=aws  \ 
</span><span style="color:#e6db74">--cluster-dns=100.64.0.10  \ 
</span><span style="color:#e6db74">--cluster-domain=cluster.local  \ 
</span><span style="color:#e6db74">--enable-debugging-handlers=true  \ 
</span><span style="color:#e6db74">--eviction-hard=memory.available&lt;100Mi,nodefs.available&lt;10%,nodefs.inodesFree&lt;5%,imagefs.available&lt;10%,imagefs.inodesFree&lt;5%  \ 
</span><span style="color:#e6db74">--feature-gates=ExperimentalCriticalPodAnnotation=true  \ 
</span><span style="color:#e6db74">--hostname-override=ip-192-168-0-114.ap-southeast-1.compute.internal  \ 
</span><span style="color:#e6db74">--kubeconfig=/var/lib/kubelet/kubeconfig  \ 
</span><span style="color:#e6db74">--network-plugin=cni  \ 
</span><span style="color:#e6db74">--node-labels=kops.k8s.io/instancegroup=master-ap-southeast-1a,kubernetes.io/role=master,node-role.kubernetes.io/master=  \ 
</span><span style="color:#e6db74">--non-masquerade-cidr=100.64.0.0/10  \ 
</span><span style="color:#e6db74">--pod-infra-container-image=k8s.gcr.io/pause-amd64:3.0  \ 
</span><span style="color:#e6db74">--pod-manifest-path=/etc/kubernetes/manifests  \ 
</span><span style="color:#e6db74">--register-schedulable=true  \ 
</span><span style="color:#e6db74">--register-with-taints=node-role.kubernetes.io/master=:NoSchedule  \ 
</span><span style="color:#e6db74">--v=2  \ 
</span><span style="color:#e6db74">--cni-bin-dir=/opt/cni/bin/  \ 
</span><span style="color:#e6db74">--cni-conf-dir=/etc/cni/net.d/&#34;</span>

HOME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/root&#34;</span>
</code></pre></div><h4 id="组件的mainfest配置">组件的mainfest配置</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#ae81ff">新加的cloudconfig </span>
<span style="color:#ae81ff">cat /etc/kubernetes/cloud.config </span>
[<span style="color:#ae81ff">global]</span>


<span style="color:#ae81ff">cat /etc/kubernetes/manifests/*</span>
<span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
<span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Pod</span>
<span style="color:#f92672">metadata</span>:
  <span style="color:#f92672">annotations</span>:
    <span style="color:#f92672">scheduler.alpha.kubernetes.io/critical-pod</span>: <span style="color:#e6db74">&#34;&#34;</span>
  <span style="color:#f92672">creationTimestamp</span>: <span style="color:#66d9ef">null</span>
  <span style="color:#f92672">labels</span>:
    <span style="color:#f92672">k8s-app</span>: <span style="color:#ae81ff">etcd-server-events</span>
  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">etcd-server-events</span>
  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">kube-system</span>
<span style="color:#f92672">spec</span>:
  <span style="color:#f92672">containers</span>:
  - <span style="color:#f92672">command</span>:
    - <span style="color:#ae81ff">/bin/sh</span>
    - -<span style="color:#ae81ff">c</span>
    - <span style="color:#ae81ff">mkfifo /tmp/pipe; (tee -a /var/log/etcd.log &lt; /tmp/pipe &amp; ) ; exec /usr/local/bin/etcd  &gt;</span>
      <span style="color:#ae81ff">/tmp/pipe 2&gt;&amp;1</span>
    <span style="color:#f92672">env</span>:
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ETCD_NAME</span>
      <span style="color:#f92672">value</span>: <span style="color:#ae81ff">etcd-events-a</span>
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ETCD_DATA_DIR</span>
      <span style="color:#f92672">value</span>: <span style="color:#ae81ff">/var/etcd/data-events</span>
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ETCD_LISTEN_PEER_URLS</span>
      <span style="color:#f92672">value</span>: <span style="color:#ae81ff">http://0.0.0.0:2381</span>
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ETCD_LISTEN_CLIENT_URLS</span>
      <span style="color:#f92672">value</span>: <span style="color:#ae81ff">http://0.0.0.0:4002</span>
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ETCD_ADVERTISE_CLIENT_URLS</span>
      <span style="color:#f92672">value</span>: <span style="color:#ae81ff">http://etcd-events-a.internal.vsxen.k8s.local:4002</span>
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ETCD_INITIAL_ADVERTISE_PEER_URLS</span>
      <span style="color:#f92672">value</span>: <span style="color:#ae81ff">http://etcd-events-a.internal.vsxen.k8s.local:2381</span>
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ETCD_INITIAL_CLUSTER_STATE</span>
      <span style="color:#f92672">value</span>: <span style="color:#ae81ff">new</span>
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ETCD_INITIAL_CLUSTER_TOKEN</span>
      <span style="color:#f92672">value</span>: <span style="color:#ae81ff">etcd-cluster-token-etcd-events</span>
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ETCD_INITIAL_CLUSTER</span>
      <span style="color:#f92672">value</span>: <span style="color:#ae81ff">etcd-events-a=http://etcd-events-a.internal.vsxen.k8s.local:2381</span>
    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">k8s.gcr.io/etcd:2.2.1</span>
    <span style="color:#f92672">livenessProbe</span>:
      <span style="color:#f92672">httpGet</span>:
        <span style="color:#f92672">host</span>: <span style="color:#ae81ff">127.0.0.1</span>
        <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/health</span>
        <span style="color:#f92672">port</span>: <span style="color:#ae81ff">4002</span>
        <span style="color:#f92672">scheme</span>: <span style="color:#ae81ff">HTTP</span>
      <span style="color:#f92672">initialDelaySeconds</span>: <span style="color:#ae81ff">15</span>
      <span style="color:#f92672">timeoutSeconds</span>: <span style="color:#ae81ff">15</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">etcd-container</span>
    <span style="color:#f92672">ports</span>:
    - <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">2381</span>
      <span style="color:#f92672">hostPort</span>: <span style="color:#ae81ff">2381</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">serverport</span>
    - <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">4002</span>
      <span style="color:#f92672">hostPort</span>: <span style="color:#ae81ff">4002</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">clientport</span>
    <span style="color:#f92672">resources</span>:
      <span style="color:#f92672">requests</span>:
        <span style="color:#f92672">cpu</span>: <span style="color:#ae81ff">100m</span>
    <span style="color:#f92672">volumeMounts</span>:
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/var/etcd/data-events</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">varetcdata</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/var/log/etcd.log</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">varlogetcd</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/etc/hosts</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">hosts</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
  <span style="color:#f92672">hostNetwork</span>: <span style="color:#66d9ef">true</span>
  <span style="color:#f92672">tolerations</span>:
  - <span style="color:#f92672">key</span>: <span style="color:#ae81ff">CriticalAddonsOnly</span>
    <span style="color:#f92672">operator</span>: <span style="color:#ae81ff">Exists</span>
  <span style="color:#f92672">volumes</span>:
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/mnt/master-vol-0e93463fa81c17e96/var/etcd/data-events</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">varetcdata</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/var/log/etcd-events.log</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">varlogetcd</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/etc/hosts</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">hosts</span>
<span style="color:#f92672">status</span>: {}
<span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
<span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Pod</span>
<span style="color:#f92672">metadata</span>:
  <span style="color:#f92672">annotations</span>:
    <span style="color:#f92672">scheduler.alpha.kubernetes.io/critical-pod</span>: <span style="color:#e6db74">&#34;&#34;</span>
  <span style="color:#f92672">creationTimestamp</span>: <span style="color:#66d9ef">null</span>
  <span style="color:#f92672">labels</span>:
    <span style="color:#f92672">k8s-app</span>: <span style="color:#ae81ff">etcd-server</span>
  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">etcd-server</span>
  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">kube-system</span>
<span style="color:#f92672">spec</span>:
  <span style="color:#f92672">containers</span>:
  - <span style="color:#f92672">command</span>:
    - <span style="color:#ae81ff">/bin/sh</span>
    - -<span style="color:#ae81ff">c</span>
    - <span style="color:#ae81ff">mkfifo /tmp/pipe; (tee -a /var/log/etcd.log &lt; /tmp/pipe &amp; ) ; exec /usr/local/bin/etcd  &gt;</span>
      <span style="color:#ae81ff">/tmp/pipe 2&gt;&amp;1</span>
    <span style="color:#f92672">env</span>:
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ETCD_NAME</span>
      <span style="color:#f92672">value</span>: <span style="color:#ae81ff">etcd-a</span>
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ETCD_DATA_DIR</span>
      <span style="color:#f92672">value</span>: <span style="color:#ae81ff">/var/etcd/data</span>
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ETCD_LISTEN_PEER_URLS</span>
      <span style="color:#f92672">value</span>: <span style="color:#ae81ff">http://0.0.0.0:2380</span>
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ETCD_LISTEN_CLIENT_URLS</span>
      <span style="color:#f92672">value</span>: <span style="color:#ae81ff">http://0.0.0.0:4001</span>
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ETCD_ADVERTISE_CLIENT_URLS</span>
      <span style="color:#f92672">value</span>: <span style="color:#ae81ff">http://etcd-a.internal.vsxen.k8s.local:4001</span>
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ETCD_INITIAL_ADVERTISE_PEER_URLS</span>
      <span style="color:#f92672">value</span>: <span style="color:#ae81ff">http://etcd-a.internal.vsxen.k8s.local:2380</span>
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ETCD_INITIAL_CLUSTER_STATE</span>
      <span style="color:#f92672">value</span>: <span style="color:#ae81ff">new</span>
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ETCD_INITIAL_CLUSTER_TOKEN</span>
      <span style="color:#f92672">value</span>: <span style="color:#ae81ff">etcd-cluster-token-etcd</span>
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ETCD_INITIAL_CLUSTER</span>
      <span style="color:#f92672">value</span>: <span style="color:#ae81ff">etcd-a=http://etcd-a.internal.vsxen.k8s.local:2380</span>
    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">k8s.gcr.io/etcd:2.2.1</span>
    <span style="color:#f92672">livenessProbe</span>:
      <span style="color:#f92672">httpGet</span>:
        <span style="color:#f92672">host</span>: <span style="color:#ae81ff">127.0.0.1</span>
        <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/health</span>
        <span style="color:#f92672">port</span>: <span style="color:#ae81ff">4001</span>
        <span style="color:#f92672">scheme</span>: <span style="color:#ae81ff">HTTP</span>
      <span style="color:#f92672">initialDelaySeconds</span>: <span style="color:#ae81ff">15</span>
      <span style="color:#f92672">timeoutSeconds</span>: <span style="color:#ae81ff">15</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">etcd-container</span>
    <span style="color:#f92672">ports</span>:
    - <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">2380</span>
      <span style="color:#f92672">hostPort</span>: <span style="color:#ae81ff">2380</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">serverport</span>
    - <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">4001</span>
      <span style="color:#f92672">hostPort</span>: <span style="color:#ae81ff">4001</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">clientport</span>
    <span style="color:#f92672">resources</span>:
      <span style="color:#f92672">requests</span>:
        <span style="color:#f92672">cpu</span>: <span style="color:#ae81ff">200m</span>
    <span style="color:#f92672">volumeMounts</span>:
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/var/etcd/data</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">varetcdata</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/var/log/etcd.log</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">varlogetcd</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/etc/hosts</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">hosts</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
  <span style="color:#f92672">hostNetwork</span>: <span style="color:#66d9ef">true</span>
  <span style="color:#f92672">tolerations</span>:
  - <span style="color:#f92672">key</span>: <span style="color:#ae81ff">CriticalAddonsOnly</span>
    <span style="color:#f92672">operator</span>: <span style="color:#ae81ff">Exists</span>
  <span style="color:#f92672">volumes</span>:
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/mnt/master-vol-0e53097f0d8a2f30d/var/etcd/data</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">varetcdata</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/var/log/etcd.log</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">varlogetcd</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/etc/hosts</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">hosts</span>
<span style="color:#f92672">status</span>: {}
<span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
<span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Pod</span>
<span style="color:#f92672">metadata</span>:
  <span style="color:#f92672">annotations</span>:
    <span style="color:#f92672">dns.alpha.kubernetes.io/internal</span>: <span style="color:#ae81ff">api.internal.vsxen.k8s.local</span>
    <span style="color:#f92672">scheduler.alpha.kubernetes.io/critical-pod</span>: <span style="color:#e6db74">&#34;&#34;</span>
  <span style="color:#f92672">creationTimestamp</span>: <span style="color:#66d9ef">null</span>
  <span style="color:#f92672">labels</span>:
    <span style="color:#f92672">k8s-app</span>: <span style="color:#ae81ff">kube-apiserver</span>
  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">kube-apiserver</span>
  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">kube-system</span>
<span style="color:#f92672">spec</span>:
  <span style="color:#f92672">containers</span>:
  - <span style="color:#f92672">command</span>:
    - <span style="color:#ae81ff">/bin/sh</span>
    - -<span style="color:#ae81ff">c</span>
    - <span style="color:#ae81ff">mkfifo /tmp/pipe; (tee -a /var/log/kube-apiserver.log &lt; /tmp/pipe &amp; ) ; exec</span>
      <span style="color:#ae81ff">/usr/local/bin/kube-apiserver --allow-privileged=true --anonymous-auth=false</span>
      --<span style="color:#ae81ff">apiserver-count=1 --authorization-mode=RBAC --basic-auth-file=/srv/kubernetes/basic_auth.csv</span>
      --<span style="color:#ae81ff">bind-address=0.0.0.0 --client-ca-file=/srv/kubernetes/ca.crt --cloud-provider=aws</span>
      --<span style="color:#ae81ff">enable-admission-plugins=Initializers,NamespaceLifecycle,LimitRanger,ServiceAccount,PersistentVolumeLabel,DefaultStorageClass,DefaultTolerationSeconds,MutatingAdmissionWebhook,ValidatingAdmissionWebhook,NodeRestriction,ResourceQuota</span>
      --<span style="color:#ae81ff">etcd-quorum-read=false --etcd-servers-overrides=/events#http://127.0.0.1:4002</span>
      --<span style="color:#ae81ff">etcd-servers=http://127.0.0.1:4001 --insecure-bind-address=127.0.0.1 --insecure-port=8080</span>
      --<span style="color:#ae81ff">kubelet-preferred-address-types=InternalIP,Hostname,ExternalIP --proxy-client-cert-file=/srv/kubernetes/apiserver-aggregator.cert</span>
      --<span style="color:#ae81ff">proxy-client-key-file=/srv/kubernetes/apiserver-aggregator.key --requestheader-allowed-names=aggregator</span>
      --<span style="color:#ae81ff">requestheader-client-ca-file=/srv/kubernetes/apiserver-aggregator-ca.cert</span>
      --<span style="color:#ae81ff">requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group</span>
      --<span style="color:#ae81ff">requestheader-username-headers=X-Remote-User --secure-port=443 --service-cluster-ip-range=100.64.0.0/13</span>
      --<span style="color:#ae81ff">storage-backend=etcd2 --tls-cert-file=/srv/kubernetes/server.cert --tls-private-key-file=/srv/kubernetes/server.key</span>
      --<span style="color:#ae81ff">token-auth-file=/srv/kubernetes/known_tokens.csv --v=2 &gt; /tmp/pipe 2&gt;&amp;1</span>
    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">k8s.gcr.io/kube-apiserver:v1.10.3</span>
    <span style="color:#f92672">livenessProbe</span>:
      <span style="color:#f92672">httpGet</span>:
        <span style="color:#f92672">host</span>: <span style="color:#ae81ff">127.0.0.1</span>
        <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/healthz</span>
        <span style="color:#f92672">port</span>: <span style="color:#ae81ff">8080</span>
      <span style="color:#f92672">initialDelaySeconds</span>: <span style="color:#ae81ff">15</span>
      <span style="color:#f92672">timeoutSeconds</span>: <span style="color:#ae81ff">15</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">kube-apiserver</span>
    <span style="color:#f92672">ports</span>:
    - <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">443</span>
      <span style="color:#f92672">hostPort</span>: <span style="color:#ae81ff">443</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">https</span>
    - <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">8080</span>
      <span style="color:#f92672">hostPort</span>: <span style="color:#ae81ff">8080</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">local</span>
    <span style="color:#f92672">resources</span>:
      <span style="color:#f92672">requests</span>:
        <span style="color:#f92672">cpu</span>: <span style="color:#ae81ff">150m</span>
    <span style="color:#f92672">volumeMounts</span>:
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/etc/ssl</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">etcssl</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/etc/pki/tls</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">etcpkitls</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/etc/pki/ca-trust</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">etcpkica-trust</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/usr/share/ssl</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">usrsharessl</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/usr/ssl</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">usrssl</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/usr/lib/ssl</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">usrlibssl</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/usr/local/openssl</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">usrlocalopenssl</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/var/ssl</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">varssl</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/etc/openssl</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">etcopenssl</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/var/log/kube-apiserver.log</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">logfile</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/srv/kubernetes</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">srvkube</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/srv/sshproxy</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">srvsshproxy</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
  <span style="color:#f92672">hostNetwork</span>: <span style="color:#66d9ef">true</span>
  <span style="color:#f92672">tolerations</span>:
  - <span style="color:#f92672">key</span>: <span style="color:#ae81ff">CriticalAddonsOnly</span>
    <span style="color:#f92672">operator</span>: <span style="color:#ae81ff">Exists</span>
  <span style="color:#f92672">volumes</span>:
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/etc/ssl</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">etcssl</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/etc/pki/tls</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">etcpkitls</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/etc/pki/ca-trust</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">etcpkica-trust</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/usr/share/ssl</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">usrsharessl</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/usr/ssl</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">usrssl</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/usr/lib/ssl</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">usrlibssl</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/usr/local/openssl</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">usrlocalopenssl</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/var/ssl</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">varssl</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/etc/openssl</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">etcopenssl</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/var/log/kube-apiserver.log</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">logfile</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/srv/kubernetes</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">srvkube</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/srv/sshproxy</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">srvsshproxy</span>
<span style="color:#f92672">status</span>: {}
<span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
<span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Pod</span>
<span style="color:#f92672">metadata</span>:
  <span style="color:#f92672">annotations</span>:
    <span style="color:#f92672">scheduler.alpha.kubernetes.io/critical-pod</span>: <span style="color:#e6db74">&#34;&#34;</span>
  <span style="color:#f92672">creationTimestamp</span>: <span style="color:#66d9ef">null</span>
  <span style="color:#f92672">labels</span>:
    <span style="color:#f92672">k8s-app</span>: <span style="color:#ae81ff">kube-controller-manager</span>
  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">kube-controller-manager</span>
  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">kube-system</span>
<span style="color:#f92672">spec</span>:
  <span style="color:#f92672">containers</span>:
  - <span style="color:#f92672">command</span>:
    - <span style="color:#ae81ff">/bin/sh</span>
    - -<span style="color:#ae81ff">c</span>
    - <span style="color:#ae81ff">mkfifo /tmp/pipe; (tee -a /var/log/kube-controller-manager.log &lt; /tmp/pipe &amp;</span>
      <span style="color:#ae81ff">) ; exec /usr/local/bin/kube-controller-manager --allocate-node-cidrs=true --attach-detach-reconcile-sync-period=1m0s</span>
      --<span style="color:#ae81ff">cloud-provider=aws --cluster-cidr=100.96.0.0/11 --cluster-name=vsxen.k8s.local</span>
      --<span style="color:#ae81ff">cluster-signing-cert-file=/srv/kubernetes/ca.crt --cluster-signing-key-file=/srv/kubernetes/ca.key</span>
      --<span style="color:#ae81ff">configure-cloud-routes=false --kubeconfig=/var/lib/kube-controller-manager/kubeconfig</span>
      --<span style="color:#ae81ff">leader-elect=true --root-ca-file=/srv/kubernetes/ca.crt --service-account-private-key-file=/srv/kubernetes/server.key</span>
      --<span style="color:#ae81ff">use-service-account-credentials=true --v=2 &gt; /tmp/pipe 2&gt;&amp;1</span>
    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">k8s.gcr.io/kube-controller-manager:v1.10.3</span>
    <span style="color:#f92672">livenessProbe</span>:
      <span style="color:#f92672">httpGet</span>:
        <span style="color:#f92672">host</span>: <span style="color:#ae81ff">127.0.0.1</span>
        <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/healthz</span>
        <span style="color:#f92672">port</span>: <span style="color:#ae81ff">10252</span>
      <span style="color:#f92672">initialDelaySeconds</span>: <span style="color:#ae81ff">15</span>
      <span style="color:#f92672">timeoutSeconds</span>: <span style="color:#ae81ff">15</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">kube-controller-manager</span>
    <span style="color:#f92672">resources</span>:
      <span style="color:#f92672">requests</span>:
        <span style="color:#f92672">cpu</span>: <span style="color:#ae81ff">100m</span>
    <span style="color:#f92672">volumeMounts</span>:
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/etc/ssl</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">etcssl</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/etc/pki/tls</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">etcpkitls</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/etc/pki/ca-trust</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">etcpkica-trust</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/usr/share/ssl</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">usrsharessl</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/usr/ssl</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">usrssl</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/usr/lib/ssl</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">usrlibssl</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/usr/local/openssl</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">usrlocalopenssl</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/var/ssl</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">varssl</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/etc/openssl</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">etcopenssl</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/srv/kubernetes</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">srvkube</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/var/log/kube-controller-manager.log</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">logfile</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/var/lib/kube-controller-manager</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">varlibkcm</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
  <span style="color:#f92672">hostNetwork</span>: <span style="color:#66d9ef">true</span>
  <span style="color:#f92672">tolerations</span>:
  - <span style="color:#f92672">key</span>: <span style="color:#ae81ff">CriticalAddonsOnly</span>
    <span style="color:#f92672">operator</span>: <span style="color:#ae81ff">Exists</span>
  <span style="color:#f92672">volumes</span>:
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/etc/ssl</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">etcssl</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/etc/pki/tls</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">etcpkitls</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/etc/pki/ca-trust</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">etcpkica-trust</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/usr/share/ssl</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">usrsharessl</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/usr/ssl</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">usrssl</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/usr/lib/ssl</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">usrlibssl</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/usr/local/openssl</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">usrlocalopenssl</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/var/ssl</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">varssl</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/etc/openssl</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">etcopenssl</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/srv/kubernetes</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">srvkube</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/var/log/kube-controller-manager.log</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">logfile</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/var/lib/kube-controller-manager</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">varlibkcm</span>
<span style="color:#f92672">status</span>: {}


<span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
<span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Pod</span>
<span style="color:#f92672">metadata</span>:
  <span style="color:#f92672">annotations</span>:
    <span style="color:#f92672">scheduler.alpha.kubernetes.io/critical-pod</span>: <span style="color:#e6db74">&#34;&#34;</span>
  <span style="color:#f92672">creationTimestamp</span>: <span style="color:#66d9ef">null</span>
  <span style="color:#f92672">labels</span>:
    <span style="color:#f92672">k8s-app</span>: <span style="color:#ae81ff">kube-proxy</span>
    <span style="color:#f92672">tier</span>: <span style="color:#ae81ff">node</span>
  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">kube-proxy</span>
  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">kube-system</span>
<span style="color:#f92672">spec</span>:
  <span style="color:#f92672">containers</span>:
  - <span style="color:#f92672">command</span>:
    - <span style="color:#ae81ff">/bin/sh</span>
    - -<span style="color:#ae81ff">c</span>
    - <span style="color:#ae81ff">mkfifo /tmp/pipe; (tee -a /var/log/kube-proxy.log &lt; /tmp/pipe &amp; ) ; exec /usr/local/bin/kube-proxy</span>
      --<span style="color:#ae81ff">cluster-cidr=100.96.0.0/11 --conntrack-max-per-core=131072 --hostname-override=ip-192-168-0-114.ap-southeast-1.compute.internal</span>
      --<span style="color:#ae81ff">kubeconfig=/var/lib/kube-proxy/kubeconfig --master=https://127.0.0.1 --oom-score-adj=-998</span>
      --<span style="color:#ae81ff">resource-container=&#34;&#34; --v=2 &gt; /tmp/pipe 2&gt;&amp;1</span>
    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">k8s.gcr.io/kube-proxy:v1.10.3</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">kube-proxy</span>
    <span style="color:#f92672">resources</span>:
      <span style="color:#f92672">requests</span>:
        <span style="color:#f92672">cpu</span>: <span style="color:#ae81ff">100m</span>
    <span style="color:#f92672">securityContext</span>:
      <span style="color:#f92672">privileged</span>: <span style="color:#66d9ef">true</span>
    <span style="color:#f92672">volumeMounts</span>:
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/var/lib/kube-proxy/kubeconfig</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">kubeconfig</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/var/log/kube-proxy.log</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">logfile</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/lib/modules</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">modules</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/etc/ssl/certs</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ssl-certs-hosts</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/etc/hosts</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">etchosts</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/run/xtables.lock</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">iptableslock</span>
  <span style="color:#f92672">hostNetwork</span>: <span style="color:#66d9ef">true</span>
  <span style="color:#f92672">tolerations</span>:
  - <span style="color:#f92672">key</span>: <span style="color:#ae81ff">CriticalAddonsOnly</span>
    <span style="color:#f92672">operator</span>: <span style="color:#ae81ff">Exists</span>
  <span style="color:#f92672">volumes</span>:
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/var/lib/kube-proxy/kubeconfig</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">kubeconfig</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/var/log/kube-proxy.log</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">logfile</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/lib/modules</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">modules</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/usr/share/ca-certificates</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ssl-certs-hosts</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/etc/hosts</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">etchosts</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/run/xtables.lock</span>
      <span style="color:#f92672">type</span>: <span style="color:#ae81ff">FileOrCreate</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">iptableslock</span>
<span style="color:#f92672">status</span>: {}


<span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
<span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Pod</span>
<span style="color:#f92672">metadata</span>:
  <span style="color:#f92672">annotations</span>:
    <span style="color:#f92672">scheduler.alpha.kubernetes.io/critical-pod</span>: <span style="color:#e6db74">&#34;&#34;</span>
  <span style="color:#f92672">creationTimestamp</span>: <span style="color:#66d9ef">null</span>
  <span style="color:#f92672">labels</span>:
    <span style="color:#f92672">k8s-app</span>: <span style="color:#ae81ff">kube-scheduler</span>
  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">kube-scheduler</span>
  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">kube-system</span>
<span style="color:#f92672">spec</span>:
  <span style="color:#f92672">containers</span>:
  - <span style="color:#f92672">command</span>:
    - <span style="color:#ae81ff">/bin/sh</span>
    - -<span style="color:#ae81ff">c</span>
    - <span style="color:#ae81ff">mkfifo /tmp/pipe; (tee -a /var/log/kube-scheduler.log &lt; /tmp/pipe &amp; ) ; exec</span>
      <span style="color:#ae81ff">/usr/local/bin/kube-scheduler --kubeconfig=/var/lib/kube-scheduler/kubeconfig</span>
      --<span style="color:#ae81ff">leader-elect=true --v=2 &gt; /tmp/pipe 2&gt;&amp;1</span>
    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">k8s.gcr.io/kube-scheduler:v1.10.3</span>
    <span style="color:#f92672">livenessProbe</span>:
      <span style="color:#f92672">httpGet</span>:
        <span style="color:#f92672">host</span>: <span style="color:#ae81ff">127.0.0.1</span>
        <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/healthz</span>
        <span style="color:#f92672">port</span>: <span style="color:#ae81ff">10251</span>
      <span style="color:#f92672">initialDelaySeconds</span>: <span style="color:#ae81ff">15</span>
      <span style="color:#f92672">timeoutSeconds</span>: <span style="color:#ae81ff">15</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">kube-scheduler</span>
    <span style="color:#f92672">resources</span>:
      <span style="color:#f92672">requests</span>:
        <span style="color:#f92672">cpu</span>: <span style="color:#ae81ff">100m</span>
    <span style="color:#f92672">volumeMounts</span>:
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/var/lib/kube-scheduler</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">varlibkubescheduler</span>
      <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">true</span>
    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/var/log/kube-scheduler.log</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">logfile</span>
  <span style="color:#f92672">hostNetwork</span>: <span style="color:#66d9ef">true</span>
  <span style="color:#f92672">tolerations</span>:
  - <span style="color:#f92672">key</span>: <span style="color:#ae81ff">CriticalAddonsOnly</span>
    <span style="color:#f92672">operator</span>: <span style="color:#ae81ff">Exists</span>
  <span style="color:#f92672">volumes</span>:
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/var/lib/kube-scheduler</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">varlibkubescheduler</span>
  - <span style="color:#f92672">hostPath</span>:
      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/var/log/kube-scheduler.log</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">logfile</span>
<span style="color:#f92672">status</span>: {}

</code></pre></div><h3 id="node">Node</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">protokube                                          1.10.0              757f84ea7739        <span style="color:#ae81ff">3</span> days ago          <span style="color:#ae81ff">278</span> MB
k8s.gcr.io/kube-proxy                              v1.10.3             4261d315109d        <span style="color:#ae81ff">2</span> months ago        97.1 MB
k8s.gcr.io/k8s-dns-dnsmasq-nanny-amd64             1.14.10             6816817d9dce        <span style="color:#ae81ff">4</span> months ago        40.4 MB
k8s.gcr.io/k8s-dns-kube-dns-amd64                  1.14.10             55ffe31ac578        <span style="color:#ae81ff">4</span> months ago        49.5 MB
k8s.gcr.io/k8s-dns-sidecar-amd64                   1.14.10             8a7739f672b4        <span style="color:#ae81ff">4</span> months ago        41.6 MB
quay.io/calico/node                                v2.6.7              7c694b9cac81        <span style="color:#ae81ff">6</span> months ago        <span style="color:#ae81ff">282</span> MB
quay.io/calico/cni                                 v1.11.2             6f0a76fc7dd2        <span style="color:#ae81ff">8</span> months ago        70.8 MB
k8s.gcr.io/cluster-proportional-autoscaler-amd64   1.1.2-r2            7d892ca550df        <span style="color:#ae81ff">14</span> months ago       49.6 MB
k8s.gcr.io/pause-amd64                             3.0                 99e59f495ffa        <span style="color:#ae81ff">2</span> years ago         <span style="color:#ae81ff">747</span> kB

ls /srv/kubernetes/
assets  ca.crt
ls /var/lib/kube*
/var/lib/kube-proxy:
kubeconfig
/var/lib/kubelet:
cpu_manager_state  device-plugins  kubeconfig  pki  plugin-containers  plugins  pods


Containers: <span style="color:#ae81ff">16</span>
 Running: <span style="color:#ae81ff">16</span>
 Paused: <span style="color:#ae81ff">0</span>
 Stopped: <span style="color:#ae81ff">0</span>
Images: <span style="color:#ae81ff">9</span>
Server Version: 17.03.2-ce
Storage Driver: overlay
 Backing Filesystem: extfs
 Supports d_type: true
Logging Driver: json-file
Cgroup Driver: cgroupfs
Plugins: 
 Volume: local
 Network: bridge host macvlan null overlay
Swarm: inactive
Runtimes: runc
Default Runtime: runc
Init Binary: docker-init
containerd version: 4ab9917febca54791c5f071a9d1f404867857fcc
runc version: 54296cf40ad8143b62dbcaa1d90e520a2136ddfe
init version: 949e6fa
Kernel Version: 4.4.121-k8s
Operating System: Debian GNU/Linux <span style="color:#ae81ff">8</span> <span style="color:#f92672">(</span>jessie<span style="color:#f92672">)</span>
OSType: linux
Architecture: x86_64
CPUs: <span style="color:#ae81ff">2</span>
Total Memory: 3.862 GiB
Name: ip-192-168-2-159
ID: TGD4:ALZB:24L5:XXMG:NHF7:2PD3:QJPI:HOM2:ERS3:GOGJ:W3XX:SRMW
Docker Root Dir: /var/lib/docker
Debug Mode <span style="color:#f92672">(</span>client<span style="color:#f92672">)</span>: false
Debug Mode <span style="color:#f92672">(</span>server<span style="color:#f92672">)</span>: false
Registry: https://index.docker.io/v1/
Experimental: false
Insecure Registries:
 127.0.0.0/8
Live Restore Enabled: false

</code></pre></div><h2 id="ref">Ref</h2>
<p>在AWS中国区使用kops安装k8s完全指南</p>
<p><a href="http://blog.geekidentity.com/k8s/kops/install-k8s-with-kops-in-china/">http://blog.geekidentity.com/k8s/kops/install-k8s-with-kops-in-china/</a></p>
</div>
        <div class="post_footer">
          
          <div class="meta">
            <div class="info">
              <span class="field tags">
                <i class="remixicon-stack-line"></i>
                
                <a href="https://vsxen.github.io/tags/k8s/">k8s</a>
                
                <a href="https://vsxen.github.io/tags/aws/">aws</a>
                
              </span>
            </div>
          </div>
          
        </div>
      </div>
      
      
    </div>
  </div>
  <a id="back_to_top" href="#" class="back_to_top"><span>△</span></a>
</div>
<div class="disqus">
  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "vsxen" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
<footer class="footer">
  <div class="powered_by">
    <a href="https://zeuk.me">Designed by Zeuk,</a>
    <a href="http://www.gohugo.io/">Proudly published with Hugo</a>
  </div>

  <div class="footer_slogan">
    <span>Software Define Everything</span>
  </div>
</footer>



<script src="https://vsxen.github.io/js/jquery-3.3.1.min.js"></script>
<script src="https://vsxen.github.io/js/zozo.js"></script>
<script src="https://vsxen.github.io/js/highlight.pack.js"></script>
<link  href="https://vsxen.github.io/css/fancybox.min.css" rel="stylesheet">
<script src="https://vsxen.github.io/js/fancybox.min.js"></script>

<script>hljs.initHighlightingOnLoad()</script>




<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-81855844-3', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>




</body>
</html>
