<!DOCTYPE html>
<html lang="en-us">
<head>
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <script type="text/javascript" src="https://latest.cactus.chat/cactus.js"></script>
  <link rel="stylesheet" href="https://latest.cactus.chat/style.css" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> k8s 集群监控 --  Prometheus Operator | Cactus theme example</title>
  <link rel = 'canonical' href = 'https://example.com/posts/promthus-operator/'>
  <meta name="description" content="随便记录点东西">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="k8s 集群监控 --  Prometheus Operator" />
<meta property="og:description" content="对于任何系统来说，监控都是不可或缺的东西，系统现在是什么样，与一周前相比是否需要调整资源等都需要一个监控系统来参考。对于k8s来说常用的开源监控方案也就是下面几种：
 heaspter&#43;InfluxDB (已被弃用) Prometheus Open falcon Telegraf&#43;InfluxDB  而且k8s所需的监控项目是比较多的，如下表：(k8s 1.14.0)    监控组件 metric PATＨ     API Server 6443/metrics   Controller Ｍanager 10257/metrics   kube Scheduler 10259/metrics   Etcd 2379/metrics   Kubelet API 10252/metrics   Cadvisor 10250/metrics/cadvisor   Node 9100/metrics    因此想要全面的监控集群状态，我个人感觉Prometheus是比较合适的，但是当你修改依次规则就需要重启一次。而且云原生中比较推荐使用声明式代替命令式，于是Prometheus Operator就诞生了，整体结构如下图：
Install 个人推荐的方式是从repo中apply一堆yaml，如果你擅长helm，也是可以的。
1git clone https://github.com/coreos/prometheus-operator 2kubectl get crd 3NAME CREATED AT 4alertmanagers.monitoring.coreos.com 2018-09-12T02:13:19Z 5prometheuses.monitoring.coreos.com 2018-09-12T02:13:19Z 6prometheusrules." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://example.com/posts/promthus-operator/" />
<meta property="article:published_time" content="2019-01-22T22:31:20+08:00" />
<meta property="article:modified_time" content="2019-01-22T22:31:20+08:00" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="k8s 集群监控 --  Prometheus Operator"/>
<meta name="twitter:description" content="对于任何系统来说，监控都是不可或缺的东西，系统现在是什么样，与一周前相比是否需要调整资源等都需要一个监控系统来参考。对于k8s来说常用的开源监控方案也就是下面几种：
 heaspter&#43;InfluxDB (已被弃用) Prometheus Open falcon Telegraf&#43;InfluxDB  而且k8s所需的监控项目是比较多的，如下表：(k8s 1.14.0)    监控组件 metric PATＨ     API Server 6443/metrics   Controller Ｍanager 10257/metrics   kube Scheduler 10259/metrics   Etcd 2379/metrics   Kubelet API 10252/metrics   Cadvisor 10250/metrics/cadvisor   Node 9100/metrics    因此想要全面的监控集群状态，我个人感觉Prometheus是比较合适的，但是当你修改依次规则就需要重启一次。而且云原生中比较推荐使用声明式代替命令式，于是Prometheus Operator就诞生了，整体结构如下图：
Install 个人推荐的方式是从repo中apply一堆yaml，如果你擅长helm，也是可以的。
1git clone https://github.com/coreos/prometheus-operator 2kubectl get crd 3NAME CREATED AT 4alertmanagers.monitoring.coreos.com 2018-09-12T02:13:19Z 5prometheuses.monitoring.coreos.com 2018-09-12T02:13:19Z 6prometheusrules."/>

  
  
    
  
  
  <link rel="stylesheet" href="https://example.com/css/styles.b7d947e05a1170a37e8b82db035a37baf568e98c7fcbe3f9dd31eac5e6a72150f9f731721fa60a1b3eed4c6a9db9c5a706d396767b698198aeea1614f88ce960.css" integrity="sha512-t9lH4FoRcKN&#43;i4LbA1o3uvVo6Yx/y&#43;P53THqxeanIVD59zFyH6YKGz7tTGqducWnBtOWdntpgZiu6hYU&#43;IzpYA=="> 

  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://example.com/images/favicon.ico" />

  
  
  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Writings</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://example.com/about/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="https://example.com/posts/kubernetes-network-flannel/" aria-label="Next">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fexample.com%2fposts%2fpromthus-operator%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fexample.com%2fposts%2fpromthus-operator%2f&text=k8s%20%e9%9b%86%e7%be%a4%e7%9b%91%e6%8e%a7%20--%20%20Prometheus%20Operator" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fexample.com%2fposts%2fpromthus-operator%2f&title=k8s%20%e9%9b%86%e7%be%a4%e7%9b%91%e6%8e%a7%20--%20%20Prometheus%20Operator" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fexample.com%2fposts%2fpromthus-operator%2f&is_video=false&description=k8s%20%e9%9b%86%e7%be%a4%e7%9b%91%e6%8e%a7%20--%20%20Prometheus%20Operator" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=k8s%20%e9%9b%86%e7%be%a4%e7%9b%91%e6%8e%a7%20--%20%20Prometheus%20Operator&body=Check out this article: https%3a%2f%2fexample.com%2fposts%2fpromthus-operator%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fexample.com%2fposts%2fpromthus-operator%2f&title=k8s%20%e9%9b%86%e7%be%a4%e7%9b%91%e6%8e%a7%20--%20%20Prometheus%20Operator" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fexample.com%2fposts%2fpromthus-operator%2f&title=k8s%20%e9%9b%86%e7%be%a4%e7%9b%91%e6%8e%a7%20--%20%20Prometheus%20Operator" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fexample.com%2fposts%2fpromthus-operator%2f&name=k8s%20%e9%9b%86%e7%be%a4%e7%9b%91%e6%8e%a7%20--%20%20Prometheus%20Operator&description=%e5%af%b9%e4%ba%8e%e4%bb%bb%e4%bd%95%e7%b3%bb%e7%bb%9f%e6%9d%a5%e8%af%b4%ef%bc%8c%e7%9b%91%e6%8e%a7%e9%83%bd%e6%98%af%e4%b8%8d%e5%8f%af%e6%88%96%e7%bc%ba%e7%9a%84%e4%b8%9c%e8%a5%bf%ef%bc%8c%e7%b3%bb%e7%bb%9f%e7%8e%b0%e5%9c%a8%e6%98%af%e4%bb%80%e4%b9%88%e6%a0%b7%ef%bc%8c%e4%b8%8e%e4%b8%80%e5%91%a8%e5%89%8d%e7%9b%b8%e6%af%94%e6%98%af%e5%90%a6%e9%9c%80%e8%a6%81%e8%b0%83%e6%95%b4%e8%b5%84%e6%ba%90%e7%ad%89%e9%83%bd%e9%9c%80%e8%a6%81%e4%b8%80%e4%b8%aa%e7%9b%91%e6%8e%a7%e7%b3%bb%e7%bb%9f%e6%9d%a5%e5%8f%82%e8%80%83%e3%80%82%e5%af%b9%e4%ba%8ek8s%e6%9d%a5%e8%af%b4%e5%b8%b8%e7%94%a8%e7%9a%84%e5%bc%80%e6%ba%90%e7%9b%91%e6%8e%a7%e6%96%b9%e6%a1%88%e4%b9%9f%e5%b0%b1%e6%98%af%e4%b8%8b%e9%9d%a2%e5%87%a0%e7%a7%8d%ef%bc%9a%0a%20heaspter%2bInfluxDB%20%28%e5%b7%b2%e8%a2%ab%e5%bc%83%e7%94%a8%29%20Prometheus%20Open%20falcon%20Telegraf%2bInfluxDB%20%20%e8%80%8c%e4%b8%94k8s%e6%89%80%e9%9c%80%e7%9a%84%e7%9b%91%e6%8e%a7%e9%a1%b9%e7%9b%ae%e6%98%af%e6%af%94%e8%be%83%e5%a4%9a%e7%9a%84%ef%bc%8c%e5%a6%82%e4%b8%8b%e8%a1%a8%ef%bc%9a%28k8s%201.14.0%29%20%20%20%20%e7%9b%91%e6%8e%a7%e7%bb%84%e4%bb%b6%20metric%20PAT%ef%bc%a8%20%20%20%20%20API%20Server%206443%2fmetrics%20%20%20Controller%20%ef%bc%adanager%2010257%2fmetrics%20%20%20kube%20Scheduler%2010259%2fmetrics%20%20%20Etcd%202379%2fmetrics%20%20%20Kubelet%20API%2010252%2fmetrics%20%20%20Cadvisor%2010250%2fmetrics%2fcadvisor%20%20%20Node%209100%2fmetrics%20%20%20%20%e5%9b%a0%e6%ad%a4%e6%83%b3%e8%a6%81%e5%85%a8%e9%9d%a2%e7%9a%84%e7%9b%91%e6%8e%a7%e9%9b%86%e7%be%a4%e7%8a%b6%e6%80%81%ef%bc%8c%e6%88%91%e4%b8%aa%e4%ba%ba%e6%84%9f%e8%a7%89Prometheus%e6%98%af%e6%af%94%e8%be%83%e5%90%88%e9%80%82%e7%9a%84%ef%bc%8c%e4%bd%86%e6%98%af%e5%bd%93%e4%bd%a0%e4%bf%ae%e6%94%b9%e4%be%9d%e6%ac%a1%e8%a7%84%e5%88%99%e5%b0%b1%e9%9c%80%e8%a6%81%e9%87%8d%e5%90%af%e4%b8%80%e6%ac%a1%e3%80%82%e8%80%8c%e4%b8%94%e4%ba%91%e5%8e%9f%e7%94%9f%e4%b8%ad%e6%af%94%e8%be%83%e6%8e%a8%e8%8d%90%e4%bd%bf%e7%94%a8%e5%a3%b0%e6%98%8e%e5%bc%8f%e4%bb%a3%e6%9b%bf%e5%91%bd%e4%bb%a4%e5%bc%8f%ef%bc%8c%e4%ba%8e%e6%98%afPrometheus%20Operator%e5%b0%b1%e8%af%9e%e7%94%9f%e4%ba%86%ef%bc%8c%e6%95%b4%e4%bd%93%e7%bb%93%e6%9e%84%e5%a6%82%e4%b8%8b%e5%9b%be%ef%bc%9a%0aInstall%20%e4%b8%aa%e4%ba%ba%e6%8e%a8%e8%8d%90%e7%9a%84%e6%96%b9%e5%bc%8f%e6%98%af%e4%bb%8erepo%e4%b8%adapply%e4%b8%80%e5%a0%86yaml%ef%bc%8c%e5%a6%82%e6%9e%9c%e4%bd%a0%e6%93%85%e9%95%bfhelm%ef%bc%8c%e4%b9%9f%e6%98%af%e5%8f%af%e4%bb%a5%e7%9a%84%e3%80%82%0a1git%20clone%20https%3a%2f%2fgithub.com%2fcoreos%2fprometheus-operator%202kubectl%20get%20crd%203NAME%20CREATED%20AT%204alertmanagers.monitoring.coreos.com%202018-09-12T02%3a13%3a19Z%205prometheuses.monitoring.coreos.com%202018-09-12T02%3a13%3a19Z%206prometheusrules." aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fexample.com%2fposts%2fpromthus-operator%2f&t=k8s%20%e9%9b%86%e7%be%a4%e7%9b%91%e6%8e%a7%20--%20%20Prometheus%20Operator" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#而且k8s所需的监控项目是比较多的如下表k8s-1140">而且k8s所需的监控项目是比较多的，如下表：(k8s 1.14.0)</a></li>
    <li><a href="#install">Install</a></li>
    <li><a href="#metrics">Metrics</a>
      <ul>
        <li><a href="#api-server">API-Server</a></li>
        <li><a href="#controller-manager--scheduler">Controller Manager &amp;&amp; Scheduler</a></li>
        <li><a href="#etcd">Etcd</a></li>
        <li><a href="#kubelet">Kubelet</a></li>
        <li><a href="#kube-state-metrics">kube state metrics</a></li>
        <li><a href="#coredns">CoreDNS</a></li>
        <li><a href="#node-exporder">Node Exporder</a></li>
      </ul>
    </li>
    <li><a href="#ref">Ref</a></li>
  </ul>
</nav>
    </div>
    
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        k8s 集群监控 --  Prometheus Operator
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2019-01-22 22:31:20 &#43;0800 CST" itemprop="datePublished">2019-01-22</time>
          
        </div>
        
        
        <div class="article-read-time">
          <i class="far fa-clock"></i>
          
          7 minute read
        </div>
        
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/tags/k8s" rel="tag">k8s</a>
            
             ,  
            <a class="tag-link" href="/tags/prometheus" rel="tag">prometheus</a>
            
        </div>
        
      </div>
    </header>

  
    
    <div class="content" itemprop="articleBody">
      <p>对于任何系统来说，监控都是不可或缺的东西，系统现在是什么样，与一周前相比是否需要调整资源等都需要一个监控系统来参考。对于k8s来说常用的开源监控方案也就是下面几种：</p>
<ol>
<li>heaspter+InfluxDB (已被弃用)</li>
<li>Prometheus</li>
<li>Open falcon</li>
<li>Telegraf+InfluxDB</li>
</ol>
<h2 id="而且k8s所需的监控项目是比较多的如下表k8s-1140">而且k8s所需的监控项目是比较多的，如下表：(k8s 1.14.0)</h2>
<table>
<thead>
<tr>
<th style="text-align:left">监控组件</th>
<th style="text-align:left">metric PATＨ</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">API Server</td>
<td style="text-align:left">6443/metrics</td>
</tr>
<tr>
<td style="text-align:left">Controller Ｍanager</td>
<td style="text-align:left">10257/metrics</td>
</tr>
<tr>
<td style="text-align:left">kube Scheduler</td>
<td style="text-align:left">10259/metrics</td>
</tr>
<tr>
<td style="text-align:left">Etcd</td>
<td style="text-align:left">2379/metrics</td>
</tr>
<tr>
<td style="text-align:left">Kubelet API</td>
<td style="text-align:left">10252/metrics</td>
</tr>
<tr>
<td style="text-align:left">Cadvisor</td>
<td style="text-align:left">10250/metrics/cadvisor</td>
</tr>
<tr>
<td style="text-align:left">Node</td>
<td style="text-align:left">9100/metrics</td>
</tr>
</tbody>
</table>
<p>因此想要全面的监控集群状态，我个人感觉Prometheus是比较合适的，但是当你修改依次规则就需要重启一次。而且云原生中比较推荐使用声明式代替命令式，于是Prometheus Operator就诞生了，整体结构如下图：</p>
<p><img src="../images/prom.jpg" alt=""></p>
<h2 id="install">Install</h2>
<p>个人推荐的方式是从repo中apply一堆yaml，如果你擅长helm，也是可以的。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>git clone https://github.com/coreos/prometheus-operator
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>kubectl get crd
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>NAME                                    CREATED AT
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>alertmanagers.monitoring.coreos.com     2018-09-12T02:13:19Z
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>prometheuses.monitoring.coreos.com      2018-09-12T02:13:19Z
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>prometheusrules.monitoring.coreos.com   2018-09-12T02:13:20Z
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span>servicemonitors.monitoring.coreos.com   2018-09-12T02:13:20Z
</code></pre></div><p>这里创建了四个CRD，分别是alertmanager实例，prometheus实例，告警规则，以及prometheus监控对象。</p>
<h2 id="metrics">Metrics</h2>
<h3 id="api-server">API-Server</h3>
<p>不需要做太多的设置，直接就可以采集到。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>APIServer Self
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>kubectl get --raw<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;/metrics&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>APIServer Proxy
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>- Kubelet 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>kubectl get --raw<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;/api/v1/nodes/</span><span style="color:#f1fa8c">${</span><span style="color:#8be9fd;font-style:italic">HOSTNAME</span><span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">/proxy/metrics&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>- Cadvisor 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span>kubectl get --raw<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;/api/v1/nodes/</span><span style="color:#f1fa8c">${</span><span style="color:#8be9fd;font-style:italic">HOSTNAME</span><span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">/proxy/metrics/cadvisor&#34;</span>
</code></pre></div><h3 id="controller-manager--scheduler">Controller Manager &amp;&amp; Scheduler</h3>
<p>需要添加对于的Service，使Prometheus发现对应的metrics。如下所示</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>cat &lt;&lt;EOF | kubectl create -f -
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#ff79c6">apiVersion</span>: v1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span style="color:#ff79c6">kind</span>: Service
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#ff79c6">metadata</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>  <span style="color:#ff79c6">namespace</span>: kube-system
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>  <span style="color:#ff79c6">name</span>: kube-controller-manager-prometheus
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>  <span style="color:#ff79c6">labels</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    <span style="color:#ff79c6">k8s-app</span>: kube-controller-manager
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span style="color:#ff79c6">spec</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>  <span style="color:#ff79c6">selector</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    <span style="color:#ff79c6">component</span>: kube-controller-manager
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>  <span style="color:#ff79c6">type</span>: ClusterIP
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>  <span style="color:#ff79c6">clusterIP</span>: None
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>  <span style="color:#ff79c6">ports</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>  - <span style="color:#ff79c6">name</span>: http-metrics
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>    <span style="color:#ff79c6">port</span>: <span style="color:#bd93f9">10252</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>    <span style="color:#ff79c6">targetPort</span>: <span style="color:#bd93f9">10252</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>    <span style="color:#ff79c6">protocol</span>: TCP
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>---    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span style="color:#ff79c6">apiVersion</span>: v1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span style="color:#ff79c6">kind</span>: Service
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span style="color:#ff79c6">metadata</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>  <span style="color:#ff79c6">namespace</span>: kube-system
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>  <span style="color:#ff79c6">name</span>: kube-scheduler-prometheus
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>  <span style="color:#ff79c6">labels</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span>    <span style="color:#ff79c6">k8s-app</span>: kube-scheduler
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span style="color:#ff79c6">spec</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span>  <span style="color:#ff79c6">selector</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span>    <span style="color:#ff79c6">component</span>: kube-scheduler
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span>  <span style="color:#ff79c6">type</span>: ClusterIP
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span>  <span style="color:#ff79c6">clusterIP</span>: None
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span>  <span style="color:#ff79c6">ports</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span>  - <span style="color:#ff79c6">name</span>: http-metrics
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span>    <span style="color:#ff79c6">port</span>: <span style="color:#bd93f9">10251</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span>    <span style="color:#ff79c6">targetPort</span>: <span style="color:#bd93f9">10251</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span>    <span style="color:#ff79c6">protocol</span>: TCP
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span>EOF
</code></pre></div><h3 id="etcd">Etcd</h3>
<p>如果你的Etcd集群启用了TLS，那么监控会稍微有点麻烦，以下内容来自https://www.qikqiak.com/post/prometheus-operator-monitor-etcd/</p>
<p>当你成功抓到Etcd的Metrics之后可以到图Grafana ID为3070的面板。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#6272a4"># 创建包含Etcd证书的secret</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>kubectl -n monitoring create secret generic etcd-certs --from-file<span style="color:#ff79c6">=</span>/etc/kubernetes/pki/etcd/healthcheck-client.crt --from-file<span style="color:#ff79c6">=</span>/etc/kubernetes/pki/etcd/healthcheck-client.key --from-file<span style="color:#ff79c6">=</span>/etc/kubernetes/pki/etcd/ca.crt
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span style="color:#6272a4"># 设置证书挂载到Prometheus中</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>  replicas: <span style="color:#bd93f9">1</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>  secrets:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>  - etcd-certs
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span style="color:#6272a4"># 创建对应的 ServiceMonitor</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>cat <span style="color:#f1fa8c">&lt;&lt;EOF | kubectl create -f -
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span style="color:#f1fa8c">apiVersion: monitoring.coreos.com/v1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span style="color:#f1fa8c">kind: ServiceMonitor
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#f1fa8c">metadata:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#f1fa8c">  name: etcd-k8s
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span style="color:#f1fa8c">  namespace: monitoring
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#f1fa8c">  labels:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#f1fa8c">    k8s-app: etcd-k8s
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#f1fa8c">spec:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#f1fa8c">  jobLabel: k8s-app
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#f1fa8c">  endpoints:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span style="color:#f1fa8c">  - port: port
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span style="color:#f1fa8c">    interval: 30s
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span style="color:#f1fa8c">    scheme: https
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span style="color:#f1fa8c">    tlsConfig:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span style="color:#f1fa8c">      caFile: /etc/prometheus/secrets/etcd-certs/ca.crt
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span style="color:#f1fa8c">      certFile: /etc/prometheus/secrets/etcd-certs/healthcheck-client.crt
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span style="color:#f1fa8c">      keyFile: /etc/prometheus/secrets/etcd-certs/healthcheck-client.key
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span style="color:#f1fa8c">      insecureSkipVerify: true
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span style="color:#f1fa8c">  selector:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span style="color:#f1fa8c">    matchLabels:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span style="color:#f1fa8c">      k8s-app: etcd
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span style="color:#f1fa8c">  namespaceSelector:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span style="color:#f1fa8c">    matchNames:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span style="color:#f1fa8c">    - kube-system
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span style="color:#f1fa8c">EOF</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span><span style="color:#6272a4">#创建Etcd的 Service</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span>cat <span style="color:#f1fa8c">&lt;&lt;EOF | kubectl create -f -    
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span><span style="color:#f1fa8c">apiVersion: v1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span><span style="color:#f1fa8c">kind: Service
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span><span style="color:#f1fa8c">metadata:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span><span style="color:#f1fa8c">  name: etcd-k8s
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span><span style="color:#f1fa8c">  namespace: kube-system
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span><span style="color:#f1fa8c">  labels:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42</span><span style="color:#f1fa8c">    k8s-app: etcd
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43</span><span style="color:#f1fa8c">spec:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44</span><span style="color:#f1fa8c">  selector:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45</span><span style="color:#f1fa8c">    component: etcd
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46</span><span style="color:#f1fa8c">  type: ClusterIP
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47</span><span style="color:#f1fa8c">  clusterIP: None
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48</span><span style="color:#f1fa8c">  ports:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49</span><span style="color:#f1fa8c">  - name: port
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50</span><span style="color:#f1fa8c">    port: 2379
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51</span><span style="color:#f1fa8c">    protocol: TCP
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52</span><span style="color:#f1fa8c">EOF</span>    
</code></pre></div><h3 id="kubelet">Kubelet</h3>
<p>分为Kubelet本身和cadvisor两个Metrics，</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#6272a4"># Kubelet</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>curl --cacert /var/lib/kubelet/pki/kubelet.crt --cert /etc/kubernetes/pki/apiserver-kubelet-client.crt --key /etc/kubernetes/pki/apiserver-kubelet-client.key  https://127.0.0.1:10250/metrics
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span style="color:#6272a4"># Cadvisor</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>curl --cacert /var/lib/kubelet/pki/kubelet.crt --cert /etc/kubernetes/pki/apiserver-kubelet-client.crt --key /etc/kubernetes/pki/apiserver-kubelet-client.key  https://127.0.0.1:10250/metrics/cadvisor
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span style="color:#6272a4"># Summary</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>curl --cacert /var/lib/kubelet/pki/kubelet.crt --cert /etc/kubernetes/pki/apiserver-kubelet-client.crt --key /etc/kubernetes/pki/apiserver-kubelet-client.y  https://ubuntu-bionic:10250/stats/summary
</code></pre></div><p>对于前者主要是一个pod，CNI，volume等等，后者则是pod内的CPU，Memory，网络流量等。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#6272a4"># 查询全部容器的CPU</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>sum by <span style="color:#ff79c6">(</span>container_name<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">(</span>rate<span style="color:#ff79c6">(</span>container_cpu_usage_seconds_total<span style="color:#ff79c6">{}[</span>1m<span style="color:#ff79c6">]))</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span style="color:#6272a4"># 查询全部容器的Memory</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>sum by <span style="color:#ff79c6">(</span>container_name<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">(</span>rate<span style="color:#ff79c6">(</span>container_memory_usage_bytes<span style="color:#ff79c6">{}[</span>1m<span style="color:#ff79c6">]))</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span style="color:#6272a4"># 查询全部容器收到的bytes</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>sort_desc<span style="color:#ff79c6">(</span>sum by <span style="color:#ff79c6">(</span>pod_name<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">(</span>rate<span style="color:#ff79c6">(</span>container_network_receive_bytes_total<span style="color:#ff79c6">[</span>1m<span style="color:#ff79c6">])</span>
</code></pre></div><h3 id="kube-state-metrics">kube state metrics</h3>
<p>作为监控设置的补充，kube-state-metrics它会轮询Kubernetes API并将有关你的Kubernetes结构化特征信息转换为metrics信息。以下是kube-state-metrics会回答的一些问题：</p>
<ul>
<li>我调度了多少个replicas？现在可用的有几个？</li>
<li>多少个Pod是running/stopped/terminated状态？</li>
<li>Pod重启了多少次？</li>
</ul>
<p>一般来说，该模型将采集Kubernetes事件并将其转换为metrics信息。需要Kubernetes 1.2+版本，不过，需要提醒的是metrics名称和标签是不稳定的，可能会改变。</p>
<p>6615 Kubernetes: DaemonSet (Prometheus)</p>
<p>5303 Kubernetes Deployment (Prometheus)</p>
<p>741  Kubernetes Deployment metrics</p>
<h3 id="coredns">CoreDNS</h3>
<p>这个在v0.29的版本中，安装完成以后就可以自动抓取到，同时导入5926 这个Dashboard模版即可观察到Coredns的监控信息。</p>
<h3 id="node-exporder">Node Exporder</h3>
<p>对于节点级别的监控，使用的 DaemonSet 启动的Node Exporder，也是比较简单的，之后导入ID 1860 的Grafana即可看到Node Exporter Full监控图。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#6272a4"># 预测磁盘将于24H内空间不足</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>predict_linear<span style="color:#ff79c6">(</span>node:node_filesystem_avail:<span style="color:#ff79c6">[</span>6h<span style="color:#ff79c6">]</span>, <span style="color:#bd93f9">3600</span> * 24<span style="color:#ff79c6">)</span>  
</code></pre></div><h2 id="ref">Ref</h2>
<p>Kubernetes监控系列（一）：Kubernetes监控开源工具基本介绍以及如何使用Sysdig进行监控</p>
<p><a href="http://dockone.io/article/4052">http://dockone.io/article/4052</a>
Prometheus监控实践：Kubernetes集群监控</p>
<p><a href="https://blog.frognew.com/2017/12/using-prometheus-to-monitor-kubernetes.html">https://blog.frognew.com/2017/12/using-prometheus-to-monitor-kubernetes.html</a>
Get Kubernetes Cluster Metrics with Prometheus in 5 Minutes</p>
<p><a href="https://akomljen.com/get-kubernetes-cluster-metrics-with-prometheus-in-5-minutes/">https://akomljen.com/get-kubernetes-cluster-metrics-with-prometheus-in-5-minutes/</a></p>
<p>k8s与监控&ndash;解读prometheus监控kubernetes的配置文件</p>
<p><a href="https://segmentfault.com/a/1190000013230914">https://segmentfault.com/a/1190000013230914</a></p>

    </div>
  </article>

  
  






  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/posts">Writings</a></li>
         
          <li><a href="/tags">Tags</a></li>
         
          <li><a href="/about">About</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#而且k8s所需的监控项目是比较多的如下表k8s-1140">而且k8s所需的监控项目是比较多的，如下表：(k8s 1.14.0)</a></li>
    <li><a href="#install">Install</a></li>
    <li><a href="#metrics">Metrics</a>
      <ul>
        <li><a href="#api-server">API-Server</a></li>
        <li><a href="#controller-manager--scheduler">Controller Manager &amp;&amp; Scheduler</a></li>
        <li><a href="#etcd">Etcd</a></li>
        <li><a href="#kubelet">Kubelet</a></li>
        <li><a href="#kube-state-metrics">kube state metrics</a></li>
        <li><a href="#coredns">CoreDNS</a></li>
        <li><a href="#node-exporder">Node Exporder</a></li>
      </ul>
    </li>
    <li><a href="#ref">Ref</a></li>
  </ul>
</nav>
    </div>
    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fexample.com%2fposts%2fpromthus-operator%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fexample.com%2fposts%2fpromthus-operator%2f&text=k8s%20%e9%9b%86%e7%be%a4%e7%9b%91%e6%8e%a7%20--%20%20Prometheus%20Operator" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fexample.com%2fposts%2fpromthus-operator%2f&title=k8s%20%e9%9b%86%e7%be%a4%e7%9b%91%e6%8e%a7%20--%20%20Prometheus%20Operator" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fexample.com%2fposts%2fpromthus-operator%2f&is_video=false&description=k8s%20%e9%9b%86%e7%be%a4%e7%9b%91%e6%8e%a7%20--%20%20Prometheus%20Operator" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=k8s%20%e9%9b%86%e7%be%a4%e7%9b%91%e6%8e%a7%20--%20%20Prometheus%20Operator&body=Check out this article: https%3a%2f%2fexample.com%2fposts%2fpromthus-operator%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fexample.com%2fposts%2fpromthus-operator%2f&title=k8s%20%e9%9b%86%e7%be%a4%e7%9b%91%e6%8e%a7%20--%20%20Prometheus%20Operator" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fexample.com%2fposts%2fpromthus-operator%2f&title=k8s%20%e9%9b%86%e7%be%a4%e7%9b%91%e6%8e%a7%20--%20%20Prometheus%20Operator" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fexample.com%2fposts%2fpromthus-operator%2f&name=k8s%20%e9%9b%86%e7%be%a4%e7%9b%91%e6%8e%a7%20--%20%20Prometheus%20Operator&description=%e5%af%b9%e4%ba%8e%e4%bb%bb%e4%bd%95%e7%b3%bb%e7%bb%9f%e6%9d%a5%e8%af%b4%ef%bc%8c%e7%9b%91%e6%8e%a7%e9%83%bd%e6%98%af%e4%b8%8d%e5%8f%af%e6%88%96%e7%bc%ba%e7%9a%84%e4%b8%9c%e8%a5%bf%ef%bc%8c%e7%b3%bb%e7%bb%9f%e7%8e%b0%e5%9c%a8%e6%98%af%e4%bb%80%e4%b9%88%e6%a0%b7%ef%bc%8c%e4%b8%8e%e4%b8%80%e5%91%a8%e5%89%8d%e7%9b%b8%e6%af%94%e6%98%af%e5%90%a6%e9%9c%80%e8%a6%81%e8%b0%83%e6%95%b4%e8%b5%84%e6%ba%90%e7%ad%89%e9%83%bd%e9%9c%80%e8%a6%81%e4%b8%80%e4%b8%aa%e7%9b%91%e6%8e%a7%e7%b3%bb%e7%bb%9f%e6%9d%a5%e5%8f%82%e8%80%83%e3%80%82%e5%af%b9%e4%ba%8ek8s%e6%9d%a5%e8%af%b4%e5%b8%b8%e7%94%a8%e7%9a%84%e5%bc%80%e6%ba%90%e7%9b%91%e6%8e%a7%e6%96%b9%e6%a1%88%e4%b9%9f%e5%b0%b1%e6%98%af%e4%b8%8b%e9%9d%a2%e5%87%a0%e7%a7%8d%ef%bc%9a%0a%20heaspter%2bInfluxDB%20%28%e5%b7%b2%e8%a2%ab%e5%bc%83%e7%94%a8%29%20Prometheus%20Open%20falcon%20Telegraf%2bInfluxDB%20%20%e8%80%8c%e4%b8%94k8s%e6%89%80%e9%9c%80%e7%9a%84%e7%9b%91%e6%8e%a7%e9%a1%b9%e7%9b%ae%e6%98%af%e6%af%94%e8%be%83%e5%a4%9a%e7%9a%84%ef%bc%8c%e5%a6%82%e4%b8%8b%e8%a1%a8%ef%bc%9a%28k8s%201.14.0%29%20%20%20%20%e7%9b%91%e6%8e%a7%e7%bb%84%e4%bb%b6%20metric%20PAT%ef%bc%a8%20%20%20%20%20API%20Server%206443%2fmetrics%20%20%20Controller%20%ef%bc%adanager%2010257%2fmetrics%20%20%20kube%20Scheduler%2010259%2fmetrics%20%20%20Etcd%202379%2fmetrics%20%20%20Kubelet%20API%2010252%2fmetrics%20%20%20Cadvisor%2010250%2fmetrics%2fcadvisor%20%20%20Node%209100%2fmetrics%20%20%20%20%e5%9b%a0%e6%ad%a4%e6%83%b3%e8%a6%81%e5%85%a8%e9%9d%a2%e7%9a%84%e7%9b%91%e6%8e%a7%e9%9b%86%e7%be%a4%e7%8a%b6%e6%80%81%ef%bc%8c%e6%88%91%e4%b8%aa%e4%ba%ba%e6%84%9f%e8%a7%89Prometheus%e6%98%af%e6%af%94%e8%be%83%e5%90%88%e9%80%82%e7%9a%84%ef%bc%8c%e4%bd%86%e6%98%af%e5%bd%93%e4%bd%a0%e4%bf%ae%e6%94%b9%e4%be%9d%e6%ac%a1%e8%a7%84%e5%88%99%e5%b0%b1%e9%9c%80%e8%a6%81%e9%87%8d%e5%90%af%e4%b8%80%e6%ac%a1%e3%80%82%e8%80%8c%e4%b8%94%e4%ba%91%e5%8e%9f%e7%94%9f%e4%b8%ad%e6%af%94%e8%be%83%e6%8e%a8%e8%8d%90%e4%bd%bf%e7%94%a8%e5%a3%b0%e6%98%8e%e5%bc%8f%e4%bb%a3%e6%9b%bf%e5%91%bd%e4%bb%a4%e5%bc%8f%ef%bc%8c%e4%ba%8e%e6%98%afPrometheus%20Operator%e5%b0%b1%e8%af%9e%e7%94%9f%e4%ba%86%ef%bc%8c%e6%95%b4%e4%bd%93%e7%bb%93%e6%9e%84%e5%a6%82%e4%b8%8b%e5%9b%be%ef%bc%9a%0aInstall%20%e4%b8%aa%e4%ba%ba%e6%8e%a8%e8%8d%90%e7%9a%84%e6%96%b9%e5%bc%8f%e6%98%af%e4%bb%8erepo%e4%b8%adapply%e4%b8%80%e5%a0%86yaml%ef%bc%8c%e5%a6%82%e6%9e%9c%e4%bd%a0%e6%93%85%e9%95%bfhelm%ef%bc%8c%e4%b9%9f%e6%98%af%e5%8f%af%e4%bb%a5%e7%9a%84%e3%80%82%0a1git%20clone%20https%3a%2f%2fgithub.com%2fcoreos%2fprometheus-operator%202kubectl%20get%20crd%203NAME%20CREATED%20AT%204alertmanagers.monitoring.coreos.com%202018-09-12T02%3a13%3a19Z%205prometheuses.monitoring.coreos.com%202018-09-12T02%3a13%3a19Z%206prometheusrules." aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fexample.com%2fposts%2fpromthus-operator%2f&t=k8s%20%e9%9b%86%e7%be%a4%e7%9b%91%e6%8e%a7%20--%20%20Prometheus%20Operator" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2025  You 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Writings</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>

<script src=/js/code-copy.js></script>




</html>
