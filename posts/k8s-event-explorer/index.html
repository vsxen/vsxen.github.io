<!DOCTYPE html>
<html lang="en-us">
<head>
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <script type="text/javascript" src="https://latest.cactus.chat/cactus.js"></script>
  <link rel="stylesheet" href="https://latest.cactus.chat/style.css" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> k8s 的实时日志 Events | Cactus theme example</title>
  <link rel = 'canonical' href = 'https://example.com/posts/k8s-event-explorer/'>
  <meta name="description" content="随便记录点东西">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="k8s 的实时日志 Events" />
<meta property="og:description" content="Event 什么是k8s的Events？比如你启动了一个Deployment，k8s的各大组件就开始依次忙碌起来，最终完成Pod的创建，从声明一个Deployment开始，到Pod启动完成，会生成一些列Events，用来告知用户现在的状态。event就是用来回答一些问题，比如为什么pod没有启动，因为没有配置私有仓库的认证，为什么pod会被Kill，因为是超过limit的限制。具体如下所示：
1kubectl get ev 2LAST SEEN TYPE REASON OBJECT MESSAGE 33s Normal Scheduled pod/nginx-698898f666-smg7t Successfully assigned default/nginx-698898f666-smg7t to east1-monitor1 43s Normal Pulled pod/nginx-698898f666-smg7t Container image &#34;nginx:alpine&#34; already present on machine 53s Normal Created pod/nginx-698898f666-smg7t Created container nginx 63s Normal Started pod/nginx-698898f666-smg7t Started container nginx 73s Normal SuccessfulCreate replicaset/nginx-698898f666 Created pod: nginx-698898f666-smg7t 83s Normal ScalingReplicaSet deployment/nginx Scaled up replica set nginx-698898f666 to 1 这些信息会被存储在Etcd中，默认的保存时间为1小时。
1/registry/events/default/nginx-698898f666-smg7t.1593fd25ca0c7e00 2/registry/events/default/nginx-698898f666-smg7t.1593fd25f1ff3cca 3/registry/events/default/nginx-698898f666-smg7t.1593fd25f4066f9f 4/registry/events/default/nginx-698898f666-smg7t.1593fd25fd741cf6 5/registry/events/default/nginx-698898f666.1593fd25c9abf7dc 6/registry/events/default/nginx.1593fd25c9217fce 找到一条Event，可以看到完整的信息如下，值得关注的地方有involvedObject的name和source的host等等。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://example.com/posts/k8s-event-explorer/" />
<meta property="article:published_time" content="2019-04-16T09:43:24+00:00" />
<meta property="article:modified_time" content="2019-04-16T09:43:24+00:00" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="k8s 的实时日志 Events"/>
<meta name="twitter:description" content="Event 什么是k8s的Events？比如你启动了一个Deployment，k8s的各大组件就开始依次忙碌起来，最终完成Pod的创建，从声明一个Deployment开始，到Pod启动完成，会生成一些列Events，用来告知用户现在的状态。event就是用来回答一些问题，比如为什么pod没有启动，因为没有配置私有仓库的认证，为什么pod会被Kill，因为是超过limit的限制。具体如下所示：
1kubectl get ev 2LAST SEEN TYPE REASON OBJECT MESSAGE 33s Normal Scheduled pod/nginx-698898f666-smg7t Successfully assigned default/nginx-698898f666-smg7t to east1-monitor1 43s Normal Pulled pod/nginx-698898f666-smg7t Container image &#34;nginx:alpine&#34; already present on machine 53s Normal Created pod/nginx-698898f666-smg7t Created container nginx 63s Normal Started pod/nginx-698898f666-smg7t Started container nginx 73s Normal SuccessfulCreate replicaset/nginx-698898f666 Created pod: nginx-698898f666-smg7t 83s Normal ScalingReplicaSet deployment/nginx Scaled up replica set nginx-698898f666 to 1 这些信息会被存储在Etcd中，默认的保存时间为1小时。
1/registry/events/default/nginx-698898f666-smg7t.1593fd25ca0c7e00 2/registry/events/default/nginx-698898f666-smg7t.1593fd25f1ff3cca 3/registry/events/default/nginx-698898f666-smg7t.1593fd25f4066f9f 4/registry/events/default/nginx-698898f666-smg7t.1593fd25fd741cf6 5/registry/events/default/nginx-698898f666.1593fd25c9abf7dc 6/registry/events/default/nginx.1593fd25c9217fce 找到一条Event，可以看到完整的信息如下，值得关注的地方有involvedObject的name和source的host等等。"/>

  
  
    
  
  
  <link rel="stylesheet" href="https://example.com/css/styles.b7d947e05a1170a37e8b82db035a37baf568e98c7fcbe3f9dd31eac5e6a72150f9f731721fa60a1b3eed4c6a9db9c5a706d396767b698198aeea1614f88ce960.css" integrity="sha512-t9lH4FoRcKN&#43;i4LbA1o3uvVo6Yx/y&#43;P53THqxeanIVD59zFyH6YKGz7tTGqducWnBtOWdntpgZiu6hYU&#43;IzpYA=="> 

  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://example.com/images/favicon.ico" />

  
  
  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Writings</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://example.com/posts/k8s-ingress-useage/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="https://example.com/posts/coredns/" aria-label="Next">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fexample.com%2fposts%2fk8s-event-explorer%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fexample.com%2fposts%2fk8s-event-explorer%2f&text=k8s%20%e7%9a%84%e5%ae%9e%e6%97%b6%e6%97%a5%e5%bf%97%20Events" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fexample.com%2fposts%2fk8s-event-explorer%2f&title=k8s%20%e7%9a%84%e5%ae%9e%e6%97%b6%e6%97%a5%e5%bf%97%20Events" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fexample.com%2fposts%2fk8s-event-explorer%2f&is_video=false&description=k8s%20%e7%9a%84%e5%ae%9e%e6%97%b6%e6%97%a5%e5%bf%97%20Events" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=k8s%20%e7%9a%84%e5%ae%9e%e6%97%b6%e6%97%a5%e5%bf%97%20Events&body=Check out this article: https%3a%2f%2fexample.com%2fposts%2fk8s-event-explorer%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fexample.com%2fposts%2fk8s-event-explorer%2f&title=k8s%20%e7%9a%84%e5%ae%9e%e6%97%b6%e6%97%a5%e5%bf%97%20Events" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fexample.com%2fposts%2fk8s-event-explorer%2f&title=k8s%20%e7%9a%84%e5%ae%9e%e6%97%b6%e6%97%a5%e5%bf%97%20Events" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fexample.com%2fposts%2fk8s-event-explorer%2f&name=k8s%20%e7%9a%84%e5%ae%9e%e6%97%b6%e6%97%a5%e5%bf%97%20Events&description=Event%20%e4%bb%80%e4%b9%88%e6%98%afk8s%e7%9a%84Events%ef%bc%9f%e6%af%94%e5%a6%82%e4%bd%a0%e5%90%af%e5%8a%a8%e4%ba%86%e4%b8%80%e4%b8%aaDeployment%ef%bc%8ck8s%e7%9a%84%e5%90%84%e5%a4%a7%e7%bb%84%e4%bb%b6%e5%b0%b1%e5%bc%80%e5%a7%8b%e4%be%9d%e6%ac%a1%e5%bf%99%e7%a2%8c%e8%b5%b7%e6%9d%a5%ef%bc%8c%e6%9c%80%e7%bb%88%e5%ae%8c%e6%88%90Pod%e7%9a%84%e5%88%9b%e5%bb%ba%ef%bc%8c%e4%bb%8e%e5%a3%b0%e6%98%8e%e4%b8%80%e4%b8%aaDeployment%e5%bc%80%e5%a7%8b%ef%bc%8c%e5%88%b0Pod%e5%90%af%e5%8a%a8%e5%ae%8c%e6%88%90%ef%bc%8c%e4%bc%9a%e7%94%9f%e6%88%90%e4%b8%80%e4%ba%9b%e5%88%97Events%ef%bc%8c%e7%94%a8%e6%9d%a5%e5%91%8a%e7%9f%a5%e7%94%a8%e6%88%b7%e7%8e%b0%e5%9c%a8%e7%9a%84%e7%8a%b6%e6%80%81%e3%80%82event%e5%b0%b1%e6%98%af%e7%94%a8%e6%9d%a5%e5%9b%9e%e7%ad%94%e4%b8%80%e4%ba%9b%e9%97%ae%e9%a2%98%ef%bc%8c%e6%af%94%e5%a6%82%e4%b8%ba%e4%bb%80%e4%b9%88pod%e6%b2%a1%e6%9c%89%e5%90%af%e5%8a%a8%ef%bc%8c%e5%9b%a0%e4%b8%ba%e6%b2%a1%e6%9c%89%e9%85%8d%e7%bd%ae%e7%a7%81%e6%9c%89%e4%bb%93%e5%ba%93%e7%9a%84%e8%ae%a4%e8%af%81%ef%bc%8c%e4%b8%ba%e4%bb%80%e4%b9%88pod%e4%bc%9a%e8%a2%abKill%ef%bc%8c%e5%9b%a0%e4%b8%ba%e6%98%af%e8%b6%85%e8%bf%87limit%e7%9a%84%e9%99%90%e5%88%b6%e3%80%82%e5%85%b7%e4%bd%93%e5%a6%82%e4%b8%8b%e6%89%80%e7%a4%ba%ef%bc%9a%0a1kubectl%20get%20ev%202LAST%20SEEN%20TYPE%20REASON%20OBJECT%20MESSAGE%2033s%20Normal%20Scheduled%20pod%2fnginx-698898f666-smg7t%20Successfully%20assigned%20default%2fnginx-698898f666-smg7t%20to%20east1-monitor1%2043s%20Normal%20Pulled%20pod%2fnginx-698898f666-smg7t%20Container%20image%20%26%2334%3bnginx%3aalpine%26%2334%3b%20already%20present%20on%20machine%2053s%20Normal%20Created%20pod%2fnginx-698898f666-smg7t%20Created%20container%20nginx%2063s%20Normal%20Started%20pod%2fnginx-698898f666-smg7t%20Started%20container%20nginx%2073s%20Normal%20SuccessfulCreate%20replicaset%2fnginx-698898f666%20Created%20pod%3a%20nginx-698898f666-smg7t%2083s%20Normal%20ScalingReplicaSet%20deployment%2fnginx%20Scaled%20up%20replica%20set%20nginx-698898f666%20to%201%20%e8%bf%99%e4%ba%9b%e4%bf%a1%e6%81%af%e4%bc%9a%e8%a2%ab%e5%ad%98%e5%82%a8%e5%9c%a8Etcd%e4%b8%ad%ef%bc%8c%e9%bb%98%e8%ae%a4%e7%9a%84%e4%bf%9d%e5%ad%98%e6%97%b6%e9%97%b4%e4%b8%ba1%e5%b0%8f%e6%97%b6%e3%80%82%0a1%2fregistry%2fevents%2fdefault%2fnginx-698898f666-smg7t.1593fd25ca0c7e00%202%2fregistry%2fevents%2fdefault%2fnginx-698898f666-smg7t.1593fd25f1ff3cca%203%2fregistry%2fevents%2fdefault%2fnginx-698898f666-smg7t.1593fd25f4066f9f%204%2fregistry%2fevents%2fdefault%2fnginx-698898f666-smg7t.1593fd25fd741cf6%205%2fregistry%2fevents%2fdefault%2fnginx-698898f666.1593fd25c9abf7dc%206%2fregistry%2fevents%2fdefault%2fnginx.1593fd25c9217fce%20%e6%89%be%e5%88%b0%e4%b8%80%e6%9d%a1Event%ef%bc%8c%e5%8f%af%e4%bb%a5%e7%9c%8b%e5%88%b0%e5%ae%8c%e6%95%b4%e7%9a%84%e4%bf%a1%e6%81%af%e5%a6%82%e4%b8%8b%ef%bc%8c%e5%80%bc%e5%be%97%e5%85%b3%e6%b3%a8%e7%9a%84%e5%9c%b0%e6%96%b9%e6%9c%89involvedObject%e7%9a%84name%e5%92%8csource%e7%9a%84host%e7%ad%89%e7%ad%89%e3%80%82" aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fexample.com%2fposts%2fk8s-event-explorer%2f&t=k8s%20%e7%9a%84%e5%ae%9e%e6%97%b6%e6%97%a5%e5%bf%97%20Events" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#event">Event</a>
      <ul>
        <li><a href="#收集">收集</a></li>
      </ul>
    </li>
    <li><a href="#审计">审计</a></li>
    <li><a href="#ref">Ref</a></li>
  </ul>
</nav>
    </div>
    
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        k8s 的实时日志 Events
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2019-04-16 09:43:24 &#43;0000 UTC" itemprop="datePublished">2019-04-16</time>
          
        </div>
        
        
        <div class="article-read-time">
          <i class="far fa-clock"></i>
          
          12 minute read
        </div>
        
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/tags/k8s" rel="tag">k8s</a>
            
             ,  
            <a class="tag-link" href="/tags/monitor" rel="tag">monitor</a>
            
        </div>
        
      </div>
    </header>

  
    
    <div class="content" itemprop="articleBody">
      <h2 id="event">Event</h2>
<p>什么是k8s的Events？比如你启动了一个Deployment，k8s的各大组件就开始依次忙碌起来，最终完成Pod的创建，从声明一个Deployment开始，到Pod启动完成，会生成一些列Events，用来告知用户现在的状态。event就是用来回答一些问题，比如为什么pod没有启动，因为没有配置私有仓库的认证，为什么pod会被Kill，因为是超过limit的限制。具体如下所示：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>kubectl get ev
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>LAST SEEN   TYPE     REASON              OBJECT                        MESSAGE
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>3s          Normal   Scheduled           pod/nginx-698898f666-smg7t    Successfully assigned default/nginx-698898f666-smg7t to east1-monitor1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>3s          Normal   Pulled              pod/nginx-698898f666-smg7t    Container image <span style="color:#f1fa8c">&#34;nginx:alpine&#34;</span> already present on machine
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>3s          Normal   Created             pod/nginx-698898f666-smg7t    Created container nginx
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>3s          Normal   Started             pod/nginx-698898f666-smg7t    Started container nginx
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span>3s          Normal   SuccessfulCreate    replicaset/nginx-698898f666   Created pod: nginx-698898f666-smg7t
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span>3s          Normal   ScalingReplicaSet   deployment/nginx              Scaled up replica <span style="color:#8be9fd;font-style:italic">set</span> nginx-698898f666 to <span style="color:#bd93f9">1</span>
</code></pre></div><p>这些信息会被存储在Etcd中，默认的保存时间为1小时。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>/registry/events/default/nginx-698898f666-smg7t.1593fd25ca0c7e00
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>/registry/events/default/nginx-698898f666-smg7t.1593fd25f1ff3cca
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>/registry/events/default/nginx-698898f666-smg7t.1593fd25f4066f9f
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>/registry/events/default/nginx-698898f666-smg7t.1593fd25fd741cf6
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>/registry/events/default/nginx-698898f666.1593fd25c9abf7dc
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>/registry/events/default/nginx.1593fd25c9217fce
</code></pre></div><p>找到一条Event，可以看到完整的信息如下，值得关注的地方有involvedObject的name和source的host等等。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#ff79c6">apiVersion</span>: v1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#ff79c6">count</span>: <span style="color:#bd93f9">1</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span style="color:#ff79c6">eventTime</span>: <span style="color:#ff79c6">null</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#ff79c6">firstTimestamp</span>: <span style="color:#f1fa8c">&#34;2019-04-10T03:01:30Z&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span style="color:#ff79c6">involvedObject</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>  <span style="color:#ff79c6">apiVersion</span>: v1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>  <span style="color:#ff79c6">fieldPath</span>: spec.containers{nginx}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>  <span style="color:#ff79c6">kind</span>: Pod
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>  <span style="color:#ff79c6">name</span>: nginx-698898f666-ldwql
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>  <span style="color:#ff79c6">namespace</span>: default
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>  <span style="color:#ff79c6">resourceVersion</span>: <span style="color:#f1fa8c">&#34;80088&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>  <span style="color:#ff79c6">uid</span>: f04efe9e-5b3c-11e9-aa09-00163e132347
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span style="color:#ff79c6">kind</span>: Event
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#ff79c6">lastTimestamp</span>: <span style="color:#f1fa8c">&#34;2019-04-10T03:01:30Z&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#ff79c6">message</span>: Container image &#34;nginx:alpine&#34; already present on machine
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#ff79c6">metadata</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>  <span style="color:#ff79c6">creationTimestamp</span>: <span style="color:#f1fa8c">&#34;2019-04-10T03:01:30Z&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>  <span style="color:#ff79c6">name</span>: nginx-698898f666-ldwql.1593fdbe68a2e26d
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>  <span style="color:#ff79c6">namespace</span>: default
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>  <span style="color:#ff79c6">resourceVersion</span>: <span style="color:#f1fa8c">&#34;80095&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>  <span style="color:#ff79c6">selfLink</span>: /api/v1/namespaces/default/events/nginx-698898f666-ldwql.1593fdbe68a2e26d
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>  <span style="color:#ff79c6">uid</span>: f0b646be-5b3c-11e9-aa09-00163e132347
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span style="color:#ff79c6">reason</span>: Pulled
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span style="color:#ff79c6">reportingComponent</span>: <span style="color:#f1fa8c">&#34;&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span style="color:#ff79c6">reportingInstance</span>: <span style="color:#f1fa8c">&#34;&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span style="color:#ff79c6">source</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span>  <span style="color:#ff79c6">component</span>: kubelet
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span>  <span style="color:#ff79c6">host</span>: k8s
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span style="color:#ff79c6">type</span>: Normal
</code></pre></div><p>与Events相关的参数主要在API Server中设置，如下所示，除此之外还可以看到审计相关的参数，也是属于event的，但是属于另外的apiVersion，以后会再介绍。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>docker run -it --rm k8s.gcr.io/kube-apiserver:v1.14.0  kube-apiserver -h |grep event
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>      --audit-log-batch-buffer-size int             The size of the buffer to store events before batching and writing. Only used in batch mode. <span style="color:#ff79c6">(</span>default 10000<span style="color:#ff79c6">)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>      --audit-log-format string                     Format of saved audits. <span style="color:#f1fa8c">&#34;legacy&#34;</span> indicates 1-line text format <span style="color:#ff79c6">for</span> each event. <span style="color:#f1fa8c">&#34;json&#34;</span> indicates structured json format. Known formats are legacy,json. <span style="color:#ff79c6">(</span>default <span style="color:#f1fa8c">&#34;json&#34;</span><span style="color:#ff79c6">)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>      --audit-log-mode string                       Strategy <span style="color:#ff79c6">for</span> sending audit events. Blocking indicates sending events should block server responses. Batch causes the backend to buffer and write events asynchronously. Known modes are batch,blocking,blocking-strict. <span style="color:#ff79c6">(</span>default <span style="color:#f1fa8c">&#34;blocking&#34;</span><span style="color:#ff79c6">)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>      --audit-log-truncate-enabled                  Whether event and batch truncating is enabled.
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>      --audit-log-truncate-max-event-size int       Maximum size of the audit event sent to the underlying backend. If the size of an event is greater than this number, first request and response are removed, and <span style="color:#ff79c6">if</span> this doesn<span style="color:#f1fa8c">&#39;t reduce the size enough, event is discarded. (default 102400)
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span style="color:#f1fa8c">      --audit-log-version string                    API group and version used for serializing audit events written to log. (default &#34;audit.k8s.io/v1&#34;)
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span style="color:#f1fa8c">      --audit-webhook-batch-buffer-size int         The size of the buffer to store events before batching and writing. Only used in batch mode. (default 10000)
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span style="color:#f1fa8c">      --audit-webhook-mode string                   Strategy for sending audit events. Blocking indicates sending events should block server responses. Batch causes the backend to buffer and write events asynchronously. Known modes are batch,blocking,blocking-strict. (default &#34;batch&#34;)
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span style="color:#f1fa8c">      --audit-webhook-truncate-enabled              Whether event and batch truncating is enabled.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#f1fa8c">      --audit-webhook-truncate-max-event-size int   Maximum size of the audit event sent to the underlying backend. If the size of an event is greater than this number, first request and response are removed, and if this doesn&#39;</span>t reduce the size enough, event is discarded. <span style="color:#ff79c6">(</span>default 102400<span style="color:#ff79c6">)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>      --audit-webhook-version string                API group and version used <span style="color:#ff79c6">for</span> serializing audit events written to webhook. <span style="color:#ff79c6">(</span>default <span style="color:#f1fa8c">&#34;audit.k8s.io/v1&#34;</span><span style="color:#ff79c6">)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>      --oidc-groups-prefix string                         If provided, all groups will be prefixed with this value to prevent conflicts with other authentication strategies.
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>      --event-ttl duration                        Amount of <span style="color:#8be9fd;font-style:italic">time</span> to retain events. <span style="color:#ff79c6">(</span>default 1h0m0s<span style="color:#ff79c6">)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>      
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4">#这个参数在大量集群集群的时候 建议使用，减少对主etcd的压力</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>      --etcd-servers-overrides strings           Per-resource etcd servers overrides, comma separated. The individual override format: group/resource#servers, where servers are URLs, semicolon separated.      
</code></pre></div><p>查看源码可以发现，event相关的代码似乎在 <a href="https://github.com/kubernetes/kubernetes/blob/release-1.14/pkg/kubelet/events/event.go">https://github.com/kubernetes/kubernetes/blob/release-1.14/pkg/kubelet/events/event.go</a> 这里。</p>
<h3 id="收集">收集</h3>
<p>对于这些集群的变更信息，如果不收集起来，对于日后的调试和问题追溯会很不方便，目前的开源的收集方案一共有以下几种：</p>
<ol>
<li><a href="https://github.com/heptiolabs/eventrouter">https://github.com/heptiolabs/eventrouter</a>  支持kafka，S3等</li>
<li><a href="https://www.elastic.co/products/beats/metricbeat">https://www.elastic.co/products/beats/metricbeat</a> 支持ES</li>
<li><a href="https://github.com/kubernetes-retired/heapster">https://github.com/kubernetes-retired/heapster</a> 支持Kafka，ES，InfluxDB（被舍弃）</li>
<li>Kube-watch发送给Slack等。</li>
</ol>
<p>下面以metricsbeat为例子，输出到ES。基于官方的一个配置进行修改，主要增加了自定义索引名字，需要ES&gt; 6.4版本</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>---
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#ff79c6">apiVersion</span>: v1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span style="color:#ff79c6">kind</span>: ConfigMap
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#ff79c6">metadata</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>  <span style="color:#ff79c6">name</span>: metricbeat-deployment-config
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>  <span style="color:#ff79c6">namespace</span>: kube-system
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>  <span style="color:#ff79c6">labels</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    <span style="color:#ff79c6">k8s-app</span>: metricbeat
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span style="color:#ff79c6">data</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>  <span style="color:#ff79c6">metricbeat.yml</span>: |-<span style="color:#f1fa8c">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#f1fa8c">    metricbeat.config.modules:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#f1fa8c">      # Mounted `metricbeat-daemonset-modules` configmap:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span style="color:#f1fa8c">      path: ${path.config}/modules.d/*.yml
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#f1fa8c">      # Reload module configs as they change:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#f1fa8c">      reload.enabled: false
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#f1fa8c">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#f1fa8c">    # processors:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#f1fa8c">    #   - add_cloud_metadata:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span style="color:#f1fa8c">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span style="color:#f1fa8c">    # cloud.id: ${ELASTIC_CLOUD_ID}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span style="color:#f1fa8c">    # cloud.auth: ${ELASTIC_CLOUD_AUTH}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span style="color:#f1fa8c">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span style="color:#f1fa8c">    output.elasticsearch:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span style="color:#f1fa8c">      hosts: [&#39;${ELASTICSEARCH_HOST:elasticsearch}:${ELASTICSEARCH_PORT:9200}&#39;]
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span style="color:#f1fa8c">      index: &#34;k8s-prod-%{[beat.version]}-%{+yyyy.MM.dd}&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span style="color:#f1fa8c">      # username: ${ELASTICSEARCH_USERNAME}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span style="color:#f1fa8c">      # password: ${ELASTICSEARCH_PASSWORD}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span style="color:#f1fa8c">    setup.template:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span style="color:#f1fa8c">      name: &#39;k8s-prod&#39;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span style="color:#f1fa8c">      pattern: &#39;k8s-prod-*&#39;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span style="color:#f1fa8c">      enabled: false</span>    
</code></pre></div><p>对于某一条event，在ES中的记录如下所示：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>  <span style="color:#ff79c6">&#34;_index&#34;</span>: <span style="color:#f1fa8c">&#34;k8s-prod-6.7.0-2019.04.09&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>  <span style="color:#ff79c6">&#34;_type&#34;</span>: <span style="color:#f1fa8c">&#34;doc&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>  <span style="color:#ff79c6">&#34;_id&#34;</span>: <span style="color:#f1fa8c">&#34;9NUDAWoBg63YcA8TN-td&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>  <span style="color:#ff79c6">&#34;_version&#34;</span>: <span style="color:#bd93f9">1</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>  <span style="color:#ff79c6">&#34;_score&#34;</span>: <span style="color:#bd93f9">1</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>  <span style="color:#ff79c6">&#34;_source&#34;</span>: {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    <span style="color:#ff79c6">&#34;@timestamp&#34;</span>: <span style="color:#f1fa8c">&#34;2019-04-09T07:32:28.142Z&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    <span style="color:#ff79c6">&#34;event&#34;</span>: {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>      <span style="color:#ff79c6">&#34;dataset&#34;</span>: <span style="color:#f1fa8c">&#34;kubernetes.event&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    },
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    <span style="color:#ff79c6">&#34;host&#34;</span>: {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>      <span style="color:#ff79c6">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;hangzhou-k8s-prod-04&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>    },
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>    <span style="color:#ff79c6">&#34;beat&#34;</span>: {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>      <span style="color:#ff79c6">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;hangzhou-k8s-prod-04&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>      <span style="color:#ff79c6">&#34;hostname&#34;</span>: <span style="color:#f1fa8c">&#34;hangzhou-k8s-prod-04&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>      <span style="color:#ff79c6">&#34;version&#34;</span>: <span style="color:#f1fa8c">&#34;6.7.0&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>    },
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>    <span style="color:#ff79c6">&#34;kubernetes&#34;</span>: {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>      <span style="color:#ff79c6">&#34;event&#34;</span>: {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>        <span style="color:#ff79c6">&#34;message&#34;</span>: <span style="color:#f1fa8c">&#34;Killing container with id docker://demo:Need to kill Pod&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>        <span style="color:#ff79c6">&#34;reason&#34;</span>: <span style="color:#f1fa8c">&#34;Killing&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>        <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Normal&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>        <span style="color:#ff79c6">&#34;count&#34;</span>: <span style="color:#bd93f9">10616</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span>        <span style="color:#ff79c6">&#34;involved_object&#34;</span>: {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span>          <span style="color:#ff79c6">&#34;resource_version&#34;</span>: <span style="color:#f1fa8c">&#34;10016180&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span>          <span style="color:#ff79c6">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;demo-8fd5f479-gmb4d&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span>          <span style="color:#ff79c6">&#34;kind&#34;</span>: <span style="color:#f1fa8c">&#34;Pod&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span>          <span style="color:#ff79c6">&#34;uid&#34;</span>: <span style="color:#f1fa8c">&#34;cba04cbc-4d0c-11e9-b6f6-00163e0f7ccb&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span>          <span style="color:#ff79c6">&#34;api_version&#34;</span>: <span style="color:#f1fa8c">&#34;v1&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span>        },
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span>        <span style="color:#ff79c6">&#34;metadata&#34;</span>: {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span>          <span style="color:#ff79c6">&#34;self_link&#34;</span>: <span style="color:#f1fa8c">&#34;/api/v1/namespaces/infra/events/demo-8fd5f479-gmb4d.158f635cd8e1c868&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span>          <span style="color:#ff79c6">&#34;generate_name&#34;</span>: <span style="color:#f1fa8c">&#34;&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span>          <span style="color:#ff79c6">&#34;uid&#34;</span>: <span style="color:#f1fa8c">&#34;48dfd324-4f74-11e9-b6f6-00163e0f7ccb&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span>          <span style="color:#ff79c6">&#34;resource_version&#34;</span>: <span style="color:#f1fa8c">&#34;12097622&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span>          <span style="color:#ff79c6">&#34;timestamp&#34;</span>: {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span>            <span style="color:#ff79c6">&#34;created&#34;</span>: <span style="color:#f1fa8c">&#34;2019-03-26T03:07:26.000Z&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span>          },
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span>          <span style="color:#ff79c6">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;demo-8fd5f479-gmb4d.158f635cd8e1c868&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42</span>          <span style="color:#ff79c6">&#34;namespace&#34;</span>: <span style="color:#f1fa8c">&#34;infra&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43</span>        },
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44</span>        <span style="color:#ff79c6">&#34;timestamp&#34;</span>: {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45</span>          <span style="color:#ff79c6">&#34;first_occurrence&#34;</span>: <span style="color:#f1fa8c">&#34;2019-03-26T03:07:26.000Z&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46</span>          <span style="color:#ff79c6">&#34;last_occurrence&#34;</span>: <span style="color:#f1fa8c">&#34;2019-04-09T07:32:28.000Z&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47</span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48</span>      }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49</span>    },
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50</span>    <span style="color:#ff79c6">&#34;metricset&#34;</span>: {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51</span>      <span style="color:#ff79c6">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;event&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52</span>      <span style="color:#ff79c6">&#34;module&#34;</span>: <span style="color:#f1fa8c">&#34;kubernetes&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54</span>  },
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55</span>  <span style="color:#ff79c6">&#34;fields&#34;</span>: {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56</span>    <span style="color:#ff79c6">&#34;kubernetes.event.timestamp.first_occurrence&#34;</span>: [
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57</span>      <span style="color:#f1fa8c">&#34;2019-03-26T03:07:26.000Z&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58</span>    ],
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59</span>    <span style="color:#ff79c6">&#34;kubernetes.event.timestamp.last_occurrence&#34;</span>: [
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60</span>      <span style="color:#f1fa8c">&#34;2019-04-09T07:32:28.000Z&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61</span>    ],
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62</span>    <span style="color:#ff79c6">&#34;kubernetes.event.metadata.timestamp.created&#34;</span>: [
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63</span>      <span style="color:#f1fa8c">&#34;2019-03-26T03:07:26.000Z&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64</span>    ],
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65</span>    <span style="color:#ff79c6">&#34;@timestamp&#34;</span>: [
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66</span>      <span style="color:#f1fa8c">&#34;2019-04-09T07:32:28.142Z&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67</span>    ]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68</span>  }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69</span>}
</code></pre></div><h2 id="审计">审计</h2>
<p>使用审计功能有两种配置方法，一个是配置policy文件，另一个是配置webhook地址。如下所示是一个policy文件</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  1</span><span style="color:#ff79c6">apiVersion</span>: audit.k8s.io/v1beta1 <span style="color:#6272a4"># This is required.</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  2</span><span style="color:#ff79c6">kind</span>: Policy
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  3</span><span style="color:#6272a4"># Don&#39;t generate audit events for all requests in RequestReceived stage.</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  4</span><span style="color:#ff79c6">omitStages</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  5</span>  - <span style="color:#f1fa8c">&#34;RequestReceived&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  6</span><span style="color:#ff79c6">rules</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  7</span>  <span style="color:#6272a4"># The following requests were manually identified as high-volume and low-risk,</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  8</span>  <span style="color:#6272a4"># so drop them.</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  9</span>  - <span style="color:#ff79c6">level</span>: None
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 10</span>    <span style="color:#ff79c6">users</span>: [<span style="color:#f1fa8c">&#34;system:kube-proxy&#34;</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 11</span>    <span style="color:#ff79c6">verbs</span>: [<span style="color:#f1fa8c">&#34;watch&#34;</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 12</span>    <span style="color:#ff79c6">resources</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 13</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#6272a4"># core</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 14</span>        <span style="color:#ff79c6">resources</span>: [<span style="color:#f1fa8c">&#34;endpoints&#34;</span>, <span style="color:#f1fa8c">&#34;services&#34;</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 15</span>  - <span style="color:#ff79c6">level</span>: None
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 16</span>    <span style="color:#ff79c6">users</span>: [<span style="color:#f1fa8c">&#34;system:unsecured&#34;</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 17</span>    <span style="color:#ff79c6">namespaces</span>: [<span style="color:#f1fa8c">&#34;kube-system&#34;</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 18</span>    <span style="color:#ff79c6">verbs</span>: [<span style="color:#f1fa8c">&#34;get&#34;</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 19</span>    <span style="color:#ff79c6">resources</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 20</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#6272a4"># core</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 21</span>        <span style="color:#ff79c6">resources</span>: [<span style="color:#f1fa8c">&#34;configmaps&#34;</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 22</span>  - <span style="color:#ff79c6">level</span>: None
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 23</span>    <span style="color:#ff79c6">users</span>: [<span style="color:#f1fa8c">&#34;kubelet&#34;</span>] <span style="color:#6272a4"># legacy kubelet identity</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 24</span>    <span style="color:#ff79c6">verbs</span>: [<span style="color:#f1fa8c">&#34;get&#34;</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 25</span>    <span style="color:#ff79c6">resources</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 26</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#6272a4"># core</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 27</span>        <span style="color:#ff79c6">resources</span>: [<span style="color:#f1fa8c">&#34;nodes&#34;</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 28</span>  - <span style="color:#ff79c6">level</span>: None
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 29</span>    <span style="color:#ff79c6">userGroups</span>: [<span style="color:#f1fa8c">&#34;system:nodes&#34;</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 30</span>    <span style="color:#ff79c6">verbs</span>: [<span style="color:#f1fa8c">&#34;get&#34;</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 31</span>    <span style="color:#ff79c6">resources</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 32</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#6272a4"># core</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 33</span>        <span style="color:#ff79c6">resources</span>: [<span style="color:#f1fa8c">&#34;nodes&#34;</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 34</span>  - <span style="color:#ff79c6">level</span>: None
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 35</span>    <span style="color:#ff79c6">users</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 36</span>      - system:kube-controller-manager
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 37</span>      - system:kube-scheduler
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 38</span>      - system:serviceaccount:kube-system:endpoint-controller
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 39</span>    <span style="color:#ff79c6">verbs</span>: [<span style="color:#f1fa8c">&#34;get&#34;</span>, <span style="color:#f1fa8c">&#34;update&#34;</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 40</span>    <span style="color:#ff79c6">namespaces</span>: [<span style="color:#f1fa8c">&#34;kube-system&#34;</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 41</span>    <span style="color:#ff79c6">resources</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 42</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#6272a4"># core</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 43</span>        <span style="color:#ff79c6">resources</span>: [<span style="color:#f1fa8c">&#34;endpoints&#34;</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 44</span>  - <span style="color:#ff79c6">level</span>: None
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 45</span>    <span style="color:#ff79c6">users</span>: [<span style="color:#f1fa8c">&#34;system:apiserver&#34;</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 46</span>    <span style="color:#ff79c6">verbs</span>: [<span style="color:#f1fa8c">&#34;get&#34;</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 47</span>    <span style="color:#ff79c6">resources</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 48</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#6272a4"># core</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 49</span>        <span style="color:#ff79c6">resources</span>: [<span style="color:#f1fa8c">&#34;namespaces&#34;</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 50</span>  <span style="color:#6272a4"># Don&#39;t log these read-only URLs.</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 51</span>  - <span style="color:#ff79c6">level</span>: None
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 52</span>    <span style="color:#ff79c6">nonResourceURLs</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 53</span>      - /healthz*
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 54</span>      - /version
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 55</span>      - /swagger*
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 56</span>  <span style="color:#6272a4"># Don&#39;t log events requests.</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 57</span>  - <span style="color:#ff79c6">level</span>: None
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 58</span>    <span style="color:#ff79c6">resources</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 59</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#6272a4"># core</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 60</span>        <span style="color:#ff79c6">resources</span>: [<span style="color:#f1fa8c">&#34;events&#34;</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 61</span>  <span style="color:#6272a4"># Secrets, ConfigMaps, and TokenReviews can contain sensitive &amp; binary data,</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 62</span>  <span style="color:#6272a4"># so only log at the Metadata level.</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 63</span>  - <span style="color:#ff79c6">level</span>: Metadata
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 64</span>    <span style="color:#ff79c6">resources</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 65</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#6272a4"># core</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 66</span>        <span style="color:#ff79c6">resources</span>: [<span style="color:#f1fa8c">&#34;secrets&#34;</span>, <span style="color:#f1fa8c">&#34;configmaps&#34;</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 67</span>      - <span style="color:#ff79c6">group</span>: authentication.k8s.io
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 68</span>        <span style="color:#ff79c6">resources</span>: [<span style="color:#f1fa8c">&#34;tokenreviews&#34;</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 69</span>  <span style="color:#6272a4"># Get repsonses can be large; skip them.</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 70</span>  - <span style="color:#ff79c6">level</span>: Request
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 71</span>    <span style="color:#ff79c6">verbs</span>: [<span style="color:#f1fa8c">&#34;get&#34;</span>, <span style="color:#f1fa8c">&#34;list&#34;</span>, <span style="color:#f1fa8c">&#34;watch&#34;</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 72</span>    <span style="color:#ff79c6">resources</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 73</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#6272a4"># core</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 74</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;admissionregistration.k8s.io&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 75</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;apps&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 76</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;authentication.k8s.io&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 77</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;authorization.k8s.io&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 78</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;autoscaling&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 79</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;batch&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 80</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;certificates.k8s.io&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 81</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;extensions&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 82</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;networking.k8s.io&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 83</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;policy&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 84</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;rbac.authorization.k8s.io&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 85</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;settings.k8s.io&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 86</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;storage.k8s.io&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 87</span>  <span style="color:#6272a4"># Default level for known APIs</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 88</span>  - <span style="color:#ff79c6">level</span>: RequestResponse
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 89</span>    <span style="color:#ff79c6">resources</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 90</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#6272a4"># core</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 91</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;admissionregistration.k8s.io&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 92</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;apps&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 93</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;authentication.k8s.io&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 94</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;authorization.k8s.io&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 95</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;autoscaling&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 96</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;batch&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 97</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;certificates.k8s.io&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 98</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;extensions&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 99</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;networking.k8s.io&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">100</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;policy&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">101</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;rbac.authorization.k8s.io&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">102</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;settings.k8s.io&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">103</span>      - <span style="color:#ff79c6">group</span>: <span style="color:#f1fa8c">&#34;storage.k8s.io&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">104</span>  <span style="color:#6272a4"># Default level for all other requests.</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">105</span>  - <span style="color:#ff79c6">level</span>: Metadata
</code></pre></div><ul>
<li>在收到请求后不立即记录日志，当返回体header发送后才开始记录。</li>
<li>对于大量冗余的kube-proxy watch请求，kubelet和system:nodes对于node的get请求，kube组件在kube-system下对于endpoint的操作，以及apiserver对于namespaces的get请求等不作审计。</li>
<li>对于/healthz*，/version*, /swagger*等只读url不作审计。</li>
<li>对于可能包含敏感信息或二进制文件的secrets，configmaps，tokenreviews接口的日志等级设为metadata，该level只记录请求事件的用户、时间戳、请求资源和动作，而不包含请求体和返回体。</li>
<li>对于一些如authenticatioin、rbac、certificates、autoscaling、storage等敏感接口，根据读写记录相应的请求体和返回体。</li>
</ul>
<p>如下是一个示例audit，表示APIServer 调用了 scheduler去调度pod。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>  <span style="color:#ff79c6">&#34;kind&#34;</span>: <span style="color:#f1fa8c">&#34;Event&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>  <span style="color:#ff79c6">&#34;apiVersion&#34;</span>: <span style="color:#f1fa8c">&#34;audit.k8s.io/v1&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>  <span style="color:#ff79c6">&#34;level&#34;</span>: <span style="color:#f1fa8c">&#34;Metadata&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>  <span style="color:#ff79c6">&#34;auditID&#34;</span>: <span style="color:#f1fa8c">&#34;774882bc-46e4-4ff5-9517-eb025a9bec0d&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>  <span style="color:#ff79c6">&#34;stage&#34;</span>: <span style="color:#f1fa8c">&#34;ResponseComplete&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>  <span style="color:#ff79c6">&#34;requestURI&#34;</span>: <span style="color:#f1fa8c">&#34;/apis/scheduling.k8s.io/v1beta1?timeout=32s&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>  <span style="color:#ff79c6">&#34;verb&#34;</span>: <span style="color:#f1fa8c">&#34;get&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>  <span style="color:#ff79c6">&#34;user&#34;</span>: {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    <span style="color:#ff79c6">&#34;username&#34;</span>: <span style="color:#f1fa8c">&#34;system:apiserver&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    <span style="color:#ff79c6">&#34;uid&#34;</span>: <span style="color:#f1fa8c">&#34;2621ccb8-dcab-4b2b-bd74-a8e94ce4340d&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    <span style="color:#ff79c6">&#34;groups&#34;</span>: [
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>      <span style="color:#f1fa8c">&#34;system:masters&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>    ]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>  },
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>  <span style="color:#ff79c6">&#34;sourceIPs&#34;</span>: [
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>    <span style="color:#f1fa8c">&#34;127.0.0.1&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>  ],
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>  <span style="color:#ff79c6">&#34;userAgent&#34;</span>: <span style="color:#f1fa8c">&#34;hyperkube/v1.13.4 (linux/amd64) kubernetes/c27b913&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>  <span style="color:#ff79c6">&#34;responseStatus&#34;</span>: {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>    <span style="color:#ff79c6">&#34;metadata&#34;</span>: {},
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>    <span style="color:#ff79c6">&#34;code&#34;</span>: <span style="color:#bd93f9">200</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>  },
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>  <span style="color:#ff79c6">&#34;requestReceivedTimestamp&#34;</span>: <span style="color:#f1fa8c">&#34;2019-04-17T06:44:27.256764Z&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>  <span style="color:#ff79c6">&#34;stageTimestamp&#34;</span>: <span style="color:#f1fa8c">&#34;2019-04-17T06:44:27.256837Z&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span>  <span style="color:#ff79c6">&#34;annotations&#34;</span>: {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span>    <span style="color:#ff79c6">&#34;authorization.k8s.io/decision&#34;</span>: <span style="color:#f1fa8c">&#34;allow&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span>    <span style="color:#ff79c6">&#34;authorization.k8s.io/reason&#34;</span>: <span style="color:#f1fa8c">&#34;&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span>  }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span>
</code></pre></div><p>可以看出都是json格式化的，这样收集就特别方便了，以下是用fluent收集的实例：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>    <span style="color:#ff79c6">&lt;source&gt;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>      @id k8s-audit.log
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>      @type tail
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>      path /var/log/kubernetes/kubernetes*
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>      pos_file /var/log/auditlog.pos
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>      tag audit.kubernetes.*
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>      read_from_head true
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>      <span style="color:#ff79c6">&lt;parse&gt;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>        @type multi_format
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>        <span style="color:#ff79c6">&lt;pattern&gt;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>          format json
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>          time_key time
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>          time_format %Y-%m-%dT%H:%M:%S.%NZ
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>        <span style="color:#ff79c6">&lt;/pattern&gt;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>      <span style="color:#ff79c6">&lt;/parse&gt;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>    <span style="color:#ff79c6">&lt;/source&gt;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>    <span style="color:#ff79c6">&lt;match</span> **<span style="color:#ff79c6">&gt;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>      @id elasticsearch
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>      @type elasticsearch
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>      @log_level info
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>      type_name _doc
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>      include_tag_key true
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>      host 1.1.1.1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>      port 9200
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span>      logstash_format true
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span>      logstash_prefix audit
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span>      <span style="color:#ff79c6">&lt;buffer&gt;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span>        @type file
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span>        path /var/log/fluentd-buffers/kubernetes.system.buffer
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span>        flush_mode interval
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span>        retry_type exponential_backoff
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span>        flush_thread_count 2
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span>        flush_interval 5s
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span>        retry_forever
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span>        retry_max_interval 30
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span>        chunk_limit_size 2M
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span>        queue_limit_length 8
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span>        overflow_action block
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span>      <span style="color:#ff79c6">&lt;/buffer&gt;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span>    <span style="color:#ff79c6">&lt;/match&gt;</span>
</code></pre></div><p>之后在es中建立对应的索引就可以方便的查看相关信息，如下图所示：</p>
<p><img src="../images/audit01.png" alt=""></p>
<p>总得来说，对于集群中的任何事件都应该关注，不论是做实时报警还是日后分析，都是非常有用的。</p>
<h2 id="ref">Ref</h2>
<p>Kubernetes(K8s)Events介绍（上）</p>
<p><a href="https://www.kubernetes.org.cn/1031.html">https://www.kubernetes.org.cn/1031.html</a></p>
<p>Scaling Kubernetes to 2,500 Nodes</p>
<p><a href="https://openai.com/blog/scaling-kubernetes-to-2500-nodes/">https://openai.com/blog/scaling-kubernetes-to-2500-nodes/</a></p>
<p>Kube-apiserver审计日志</p>
<p><a href="https://help.aliyun.com/document_detail/91406.html">https://help.aliyun.com/document_detail/91406.html</a></p>
<p>Audit</p>
<p><a href="https://kubernetes.io/docs/tasks/debug-application-cluster/audit/">https://kubernetes.io/docs/tasks/debug-application-cluster/audit/</a></p>

    </div>
  </article>

  
  






  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/posts">Writings</a></li>
         
          <li><a href="/tags">Tags</a></li>
         
          <li><a href="/about">About</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#event">Event</a>
      <ul>
        <li><a href="#收集">收集</a></li>
      </ul>
    </li>
    <li><a href="#审计">审计</a></li>
    <li><a href="#ref">Ref</a></li>
  </ul>
</nav>
    </div>
    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fexample.com%2fposts%2fk8s-event-explorer%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fexample.com%2fposts%2fk8s-event-explorer%2f&text=k8s%20%e7%9a%84%e5%ae%9e%e6%97%b6%e6%97%a5%e5%bf%97%20Events" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fexample.com%2fposts%2fk8s-event-explorer%2f&title=k8s%20%e7%9a%84%e5%ae%9e%e6%97%b6%e6%97%a5%e5%bf%97%20Events" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fexample.com%2fposts%2fk8s-event-explorer%2f&is_video=false&description=k8s%20%e7%9a%84%e5%ae%9e%e6%97%b6%e6%97%a5%e5%bf%97%20Events" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=k8s%20%e7%9a%84%e5%ae%9e%e6%97%b6%e6%97%a5%e5%bf%97%20Events&body=Check out this article: https%3a%2f%2fexample.com%2fposts%2fk8s-event-explorer%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fexample.com%2fposts%2fk8s-event-explorer%2f&title=k8s%20%e7%9a%84%e5%ae%9e%e6%97%b6%e6%97%a5%e5%bf%97%20Events" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fexample.com%2fposts%2fk8s-event-explorer%2f&title=k8s%20%e7%9a%84%e5%ae%9e%e6%97%b6%e6%97%a5%e5%bf%97%20Events" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fexample.com%2fposts%2fk8s-event-explorer%2f&name=k8s%20%e7%9a%84%e5%ae%9e%e6%97%b6%e6%97%a5%e5%bf%97%20Events&description=Event%20%e4%bb%80%e4%b9%88%e6%98%afk8s%e7%9a%84Events%ef%bc%9f%e6%af%94%e5%a6%82%e4%bd%a0%e5%90%af%e5%8a%a8%e4%ba%86%e4%b8%80%e4%b8%aaDeployment%ef%bc%8ck8s%e7%9a%84%e5%90%84%e5%a4%a7%e7%bb%84%e4%bb%b6%e5%b0%b1%e5%bc%80%e5%a7%8b%e4%be%9d%e6%ac%a1%e5%bf%99%e7%a2%8c%e8%b5%b7%e6%9d%a5%ef%bc%8c%e6%9c%80%e7%bb%88%e5%ae%8c%e6%88%90Pod%e7%9a%84%e5%88%9b%e5%bb%ba%ef%bc%8c%e4%bb%8e%e5%a3%b0%e6%98%8e%e4%b8%80%e4%b8%aaDeployment%e5%bc%80%e5%a7%8b%ef%bc%8c%e5%88%b0Pod%e5%90%af%e5%8a%a8%e5%ae%8c%e6%88%90%ef%bc%8c%e4%bc%9a%e7%94%9f%e6%88%90%e4%b8%80%e4%ba%9b%e5%88%97Events%ef%bc%8c%e7%94%a8%e6%9d%a5%e5%91%8a%e7%9f%a5%e7%94%a8%e6%88%b7%e7%8e%b0%e5%9c%a8%e7%9a%84%e7%8a%b6%e6%80%81%e3%80%82event%e5%b0%b1%e6%98%af%e7%94%a8%e6%9d%a5%e5%9b%9e%e7%ad%94%e4%b8%80%e4%ba%9b%e9%97%ae%e9%a2%98%ef%bc%8c%e6%af%94%e5%a6%82%e4%b8%ba%e4%bb%80%e4%b9%88pod%e6%b2%a1%e6%9c%89%e5%90%af%e5%8a%a8%ef%bc%8c%e5%9b%a0%e4%b8%ba%e6%b2%a1%e6%9c%89%e9%85%8d%e7%bd%ae%e7%a7%81%e6%9c%89%e4%bb%93%e5%ba%93%e7%9a%84%e8%ae%a4%e8%af%81%ef%bc%8c%e4%b8%ba%e4%bb%80%e4%b9%88pod%e4%bc%9a%e8%a2%abKill%ef%bc%8c%e5%9b%a0%e4%b8%ba%e6%98%af%e8%b6%85%e8%bf%87limit%e7%9a%84%e9%99%90%e5%88%b6%e3%80%82%e5%85%b7%e4%bd%93%e5%a6%82%e4%b8%8b%e6%89%80%e7%a4%ba%ef%bc%9a%0a1kubectl%20get%20ev%202LAST%20SEEN%20TYPE%20REASON%20OBJECT%20MESSAGE%2033s%20Normal%20Scheduled%20pod%2fnginx-698898f666-smg7t%20Successfully%20assigned%20default%2fnginx-698898f666-smg7t%20to%20east1-monitor1%2043s%20Normal%20Pulled%20pod%2fnginx-698898f666-smg7t%20Container%20image%20%26%2334%3bnginx%3aalpine%26%2334%3b%20already%20present%20on%20machine%2053s%20Normal%20Created%20pod%2fnginx-698898f666-smg7t%20Created%20container%20nginx%2063s%20Normal%20Started%20pod%2fnginx-698898f666-smg7t%20Started%20container%20nginx%2073s%20Normal%20SuccessfulCreate%20replicaset%2fnginx-698898f666%20Created%20pod%3a%20nginx-698898f666-smg7t%2083s%20Normal%20ScalingReplicaSet%20deployment%2fnginx%20Scaled%20up%20replica%20set%20nginx-698898f666%20to%201%20%e8%bf%99%e4%ba%9b%e4%bf%a1%e6%81%af%e4%bc%9a%e8%a2%ab%e5%ad%98%e5%82%a8%e5%9c%a8Etcd%e4%b8%ad%ef%bc%8c%e9%bb%98%e8%ae%a4%e7%9a%84%e4%bf%9d%e5%ad%98%e6%97%b6%e9%97%b4%e4%b8%ba1%e5%b0%8f%e6%97%b6%e3%80%82%0a1%2fregistry%2fevents%2fdefault%2fnginx-698898f666-smg7t.1593fd25ca0c7e00%202%2fregistry%2fevents%2fdefault%2fnginx-698898f666-smg7t.1593fd25f1ff3cca%203%2fregistry%2fevents%2fdefault%2fnginx-698898f666-smg7t.1593fd25f4066f9f%204%2fregistry%2fevents%2fdefault%2fnginx-698898f666-smg7t.1593fd25fd741cf6%205%2fregistry%2fevents%2fdefault%2fnginx-698898f666.1593fd25c9abf7dc%206%2fregistry%2fevents%2fdefault%2fnginx.1593fd25c9217fce%20%e6%89%be%e5%88%b0%e4%b8%80%e6%9d%a1Event%ef%bc%8c%e5%8f%af%e4%bb%a5%e7%9c%8b%e5%88%b0%e5%ae%8c%e6%95%b4%e7%9a%84%e4%bf%a1%e6%81%af%e5%a6%82%e4%b8%8b%ef%bc%8c%e5%80%bc%e5%be%97%e5%85%b3%e6%b3%a8%e7%9a%84%e5%9c%b0%e6%96%b9%e6%9c%89involvedObject%e7%9a%84name%e5%92%8csource%e7%9a%84host%e7%ad%89%e7%ad%89%e3%80%82" aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fexample.com%2fposts%2fk8s-event-explorer%2f&t=k8s%20%e7%9a%84%e5%ae%9e%e6%97%b6%e6%97%a5%e5%bf%97%20Events" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2025  You 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Writings</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>

<script src=/js/code-copy.js></script>




</html>
