<!DOCTYPE html>
<html lang="en-us">
<head>
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <script type="text/javascript" src="https://latest.cactus.chat/cactus.js"></script>
  <link rel="stylesheet" href="https://latest.cactus.chat/style.css" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> 2021 | Cactus theme example</title>
  <link rel = 'canonical' href = 'https://example.com/posts/2021/'>
  <meta name="description" content="随便记录点东西">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="2021" />
<meta property="og:description" content="​	先说下CIS（Container Ingress Services）吧，也就是这个(https://github.com/F5Networks/k8s-bigip-ctlr) ，目的是为集群内的四层业务提供负载均衡，项目的初衷是为容器内的redis提供访问入口，毕竟pod的IP会变，之前是用Nginx ingress的四层stream做反向代理，那就要改configmap。（这里插一下redis在集群的模式是可以由一个入口进来，然后把流量转到 key 所在的 slot 所在的redis实例，也就是redis节点可以感知集群的其他节点。对于etcd？）由于各种原因开始测试这个CIS，网络那边还为此配置了 ECMP （https://en.wikipedia.org/wiki/Equal-cost_multi-path_routing），同时 ECMP 限制下一跳节点最多是16个，我们还为此搞出了Group到Namespace一对多的规划，每个Group计划流量大概40G吧😄。先说下这个CIS的奇葩之处吧，我们都知道根据Ingress的设计，最主要的是要找到Ingress对应的Service名字（名字在namespace级别是唯一的），根据名字来实现对应关系。但是CIS确是根据Service的label来关连的，而且CIS的对应关系是写在configmap里面，不支持多个configmap，也就是多个数组来表示不同的负载均衡。这里只是用ingress作为示例，表示我不是很赞同这个关系映射方式，因为你一个负载均衡的只需要知道Service名字，进而查出来bankend IP就好了，不应该在Service上面做事情。
1# ingress 版  2apiVersion: extensions/v1beta1 3kind: Ingress 4metadata: 5 name: app 6spec: 7 rules: 8 - host: vsxen.github.io 9 http: 10 paths: 11 - backend: 12 serviceName: nginx 13 servicePort: 80 14--- 15# CIS版 16apiVersion: v1 17kind: Service 18metadata: 19 labels: 20 cis-app: &#34;app&#34; 21 cis-port: &#34;443&#34; 22 name: app 23spec: 24 ports: 25 - name: https 26 port: 443 27 protocol: TCP 28 targetPort: 6443 ​	当然对应私有云的环境，也有 https://github." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://example.com/posts/2021/" />
<meta property="article:published_time" content="2022-03-06T18:34:11+08:00" />
<meta property="article:modified_time" content="2022-03-06T18:34:11+08:00" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="2021"/>
<meta name="twitter:description" content="​	先说下CIS（Container Ingress Services）吧，也就是这个(https://github.com/F5Networks/k8s-bigip-ctlr) ，目的是为集群内的四层业务提供负载均衡，项目的初衷是为容器内的redis提供访问入口，毕竟pod的IP会变，之前是用Nginx ingress的四层stream做反向代理，那就要改configmap。（这里插一下redis在集群的模式是可以由一个入口进来，然后把流量转到 key 所在的 slot 所在的redis实例，也就是redis节点可以感知集群的其他节点。对于etcd？）由于各种原因开始测试这个CIS，网络那边还为此配置了 ECMP （https://en.wikipedia.org/wiki/Equal-cost_multi-path_routing），同时 ECMP 限制下一跳节点最多是16个，我们还为此搞出了Group到Namespace一对多的规划，每个Group计划流量大概40G吧😄。先说下这个CIS的奇葩之处吧，我们都知道根据Ingress的设计，最主要的是要找到Ingress对应的Service名字（名字在namespace级别是唯一的），根据名字来实现对应关系。但是CIS确是根据Service的label来关连的，而且CIS的对应关系是写在configmap里面，不支持多个configmap，也就是多个数组来表示不同的负载均衡。这里只是用ingress作为示例，表示我不是很赞同这个关系映射方式，因为你一个负载均衡的只需要知道Service名字，进而查出来bankend IP就好了，不应该在Service上面做事情。
1# ingress 版  2apiVersion: extensions/v1beta1 3kind: Ingress 4metadata: 5 name: app 6spec: 7 rules: 8 - host: vsxen.github.io 9 http: 10 paths: 11 - backend: 12 serviceName: nginx 13 servicePort: 80 14--- 15# CIS版 16apiVersion: v1 17kind: Service 18metadata: 19 labels: 20 cis-app: &#34;app&#34; 21 cis-port: &#34;443&#34; 22 name: app 23spec: 24 ports: 25 - name: https 26 port: 443 27 protocol: TCP 28 targetPort: 6443 ​	当然对应私有云的环境，也有 https://github."/>

  
  
    
  
  
  <link rel="stylesheet" href="https://example.com/css/styles.b7d947e05a1170a37e8b82db035a37baf568e98c7fcbe3f9dd31eac5e6a72150f9f731721fa60a1b3eed4c6a9db9c5a706d396767b698198aeea1614f88ce960.css" integrity="sha512-t9lH4FoRcKN&#43;i4LbA1o3uvVo6Yx/y&#43;P53THqxeanIVD59zFyH6YKGz7tTGqducWnBtOWdntpgZiu6hYU&#43;IzpYA=="> 

  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://example.com/images/favicon.ico" />

  
  
  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Writings</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://example.com/posts/uprade-kernel/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fexample.com%2fposts%2f2021%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fexample.com%2fposts%2f2021%2f&text=2021" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fexample.com%2fposts%2f2021%2f&title=2021" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fexample.com%2fposts%2f2021%2f&is_video=false&description=2021" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=2021&body=Check out this article: https%3a%2f%2fexample.com%2fposts%2f2021%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fexample.com%2fposts%2f2021%2f&title=2021" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fexample.com%2fposts%2f2021%2f&title=2021" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fexample.com%2fposts%2f2021%2f&name=2021&description=%e2%80%8b%09%e5%85%88%e8%af%b4%e4%b8%8bCIS%ef%bc%88Container%20Ingress%20Services%ef%bc%89%e5%90%a7%ef%bc%8c%e4%b9%9f%e5%b0%b1%e6%98%af%e8%bf%99%e4%b8%aa%28https%3a%2f%2fgithub.com%2fF5Networks%2fk8s-bigip-ctlr%29%20%ef%bc%8c%e7%9b%ae%e7%9a%84%e6%98%af%e4%b8%ba%e9%9b%86%e7%be%a4%e5%86%85%e7%9a%84%e5%9b%9b%e5%b1%82%e4%b8%9a%e5%8a%a1%e6%8f%90%e4%be%9b%e8%b4%9f%e8%bd%bd%e5%9d%87%e8%a1%a1%ef%bc%8c%e9%a1%b9%e7%9b%ae%e7%9a%84%e5%88%9d%e8%a1%b7%e6%98%af%e4%b8%ba%e5%ae%b9%e5%99%a8%e5%86%85%e7%9a%84redis%e6%8f%90%e4%be%9b%e8%ae%bf%e9%97%ae%e5%85%a5%e5%8f%a3%ef%bc%8c%e6%af%95%e7%ab%9fpod%e7%9a%84IP%e4%bc%9a%e5%8f%98%ef%bc%8c%e4%b9%8b%e5%89%8d%e6%98%af%e7%94%a8Nginx%20ingress%e7%9a%84%e5%9b%9b%e5%b1%82stream%e5%81%9a%e5%8f%8d%e5%90%91%e4%bb%a3%e7%90%86%ef%bc%8c%e9%82%a3%e5%b0%b1%e8%a6%81%e6%94%b9configmap%e3%80%82%ef%bc%88%e8%bf%99%e9%87%8c%e6%8f%92%e4%b8%80%e4%b8%8bredis%e5%9c%a8%e9%9b%86%e7%be%a4%e7%9a%84%e6%a8%a1%e5%bc%8f%e6%98%af%e5%8f%af%e4%bb%a5%e7%94%b1%e4%b8%80%e4%b8%aa%e5%85%a5%e5%8f%a3%e8%bf%9b%e6%9d%a5%ef%bc%8c%e7%84%b6%e5%90%8e%e6%8a%8a%e6%b5%81%e9%87%8f%e8%bd%ac%e5%88%b0%20key%20%e6%89%80%e5%9c%a8%e7%9a%84%20slot%20%e6%89%80%e5%9c%a8%e7%9a%84redis%e5%ae%9e%e4%be%8b%ef%bc%8c%e4%b9%9f%e5%b0%b1%e6%98%afredis%e8%8a%82%e7%82%b9%e5%8f%af%e4%bb%a5%e6%84%9f%e7%9f%a5%e9%9b%86%e7%be%a4%e7%9a%84%e5%85%b6%e4%bb%96%e8%8a%82%e7%82%b9%e3%80%82%e5%af%b9%e4%ba%8eetcd%ef%bc%9f%ef%bc%89%e7%94%b1%e4%ba%8e%e5%90%84%e7%a7%8d%e5%8e%9f%e5%9b%a0%e5%bc%80%e5%a7%8b%e6%b5%8b%e8%af%95%e8%bf%99%e4%b8%aaCIS%ef%bc%8c%e7%bd%91%e7%bb%9c%e9%82%a3%e8%be%b9%e8%bf%98%e4%b8%ba%e6%ad%a4%e9%85%8d%e7%bd%ae%e4%ba%86%20ECMP%20%ef%bc%88https%3a%2f%2fen.wikipedia.org%2fwiki%2fEqual-cost_multi-path_routing%ef%bc%89%ef%bc%8c%e5%90%8c%e6%97%b6%20ECMP%20%e9%99%90%e5%88%b6%e4%b8%8b%e4%b8%80%e8%b7%b3%e8%8a%82%e7%82%b9%e6%9c%80%e5%a4%9a%e6%98%af16%e4%b8%aa%ef%bc%8c%e6%88%91%e4%bb%ac%e8%bf%98%e4%b8%ba%e6%ad%a4%e6%90%9e%e5%87%ba%e4%ba%86Group%e5%88%b0Namespace%e4%b8%80%e5%af%b9%e5%a4%9a%e7%9a%84%e8%a7%84%e5%88%92%ef%bc%8c%e6%af%8f%e4%b8%aaGroup%e8%ae%a1%e5%88%92%e6%b5%81%e9%87%8f%e5%a4%a7%e6%a6%8240G%e5%90%a7%f0%9f%98%84%e3%80%82%e5%85%88%e8%af%b4%e4%b8%8b%e8%bf%99%e4%b8%aaCIS%e7%9a%84%e5%a5%87%e8%91%a9%e4%b9%8b%e5%a4%84%e5%90%a7%ef%bc%8c%e6%88%91%e4%bb%ac%e9%83%bd%e7%9f%a5%e9%81%93%e6%a0%b9%e6%8d%aeIngress%e7%9a%84%e8%ae%be%e8%ae%a1%ef%bc%8c%e6%9c%80%e4%b8%bb%e8%a6%81%e7%9a%84%e6%98%af%e8%a6%81%e6%89%be%e5%88%b0Ingress%e5%af%b9%e5%ba%94%e7%9a%84Service%e5%90%8d%e5%ad%97%ef%bc%88%e5%90%8d%e5%ad%97%e5%9c%a8namespace%e7%ba%a7%e5%88%ab%e6%98%af%e5%94%af%e4%b8%80%e7%9a%84%ef%bc%89%ef%bc%8c%e6%a0%b9%e6%8d%ae%e5%90%8d%e5%ad%97%e6%9d%a5%e5%ae%9e%e7%8e%b0%e5%af%b9%e5%ba%94%e5%85%b3%e7%b3%bb%e3%80%82%e4%bd%86%e6%98%afCIS%e7%a1%ae%e6%98%af%e6%a0%b9%e6%8d%aeService%e7%9a%84label%e6%9d%a5%e5%85%b3%e8%bf%9e%e7%9a%84%ef%bc%8c%e8%80%8c%e4%b8%94CIS%e7%9a%84%e5%af%b9%e5%ba%94%e5%85%b3%e7%b3%bb%e6%98%af%e5%86%99%e5%9c%a8configmap%e9%87%8c%e9%9d%a2%ef%bc%8c%e4%b8%8d%e6%94%af%e6%8c%81%e5%a4%9a%e4%b8%aaconfigmap%ef%bc%8c%e4%b9%9f%e5%b0%b1%e6%98%af%e5%a4%9a%e4%b8%aa%e6%95%b0%e7%bb%84%e6%9d%a5%e8%a1%a8%e7%a4%ba%e4%b8%8d%e5%90%8c%e7%9a%84%e8%b4%9f%e8%bd%bd%e5%9d%87%e8%a1%a1%e3%80%82%e8%bf%99%e9%87%8c%e5%8f%aa%e6%98%af%e7%94%a8ingress%e4%bd%9c%e4%b8%ba%e7%a4%ba%e4%be%8b%ef%bc%8c%e8%a1%a8%e7%a4%ba%e6%88%91%e4%b8%8d%e6%98%af%e5%be%88%e8%b5%9e%e5%90%8c%e8%bf%99%e4%b8%aa%e5%85%b3%e7%b3%bb%e6%98%a0%e5%b0%84%e6%96%b9%e5%bc%8f%ef%bc%8c%e5%9b%a0%e4%b8%ba%e4%bd%a0%e4%b8%80%e4%b8%aa%e8%b4%9f%e8%bd%bd%e5%9d%87%e8%a1%a1%e7%9a%84%e5%8f%aa%e9%9c%80%e8%a6%81%e7%9f%a5%e9%81%93Service%e5%90%8d%e5%ad%97%ef%bc%8c%e8%bf%9b%e8%80%8c%e6%9f%a5%e5%87%ba%e6%9d%a5bankend%20IP%e5%b0%b1%e5%a5%bd%e4%ba%86%ef%bc%8c%e4%b8%8d%e5%ba%94%e8%af%a5%e5%9c%a8Service%e4%b8%8a%e9%9d%a2%e5%81%9a%e4%ba%8b%e6%83%85%e3%80%82%0a1%23%20ingress%20%e7%89%88%20%202apiVersion%3a%20extensions%2fv1beta1%203kind%3a%20Ingress%204metadata%3a%205%20name%3a%20app%206spec%3a%207%20rules%3a%208%20-%20host%3a%20vsxen.github.io%209%20http%3a%2010%20paths%3a%2011%20-%20backend%3a%2012%20serviceName%3a%20nginx%2013%20servicePort%3a%2080%2014---%2015%23%20CIS%e7%89%88%2016apiVersion%3a%20v1%2017kind%3a%20Service%2018metadata%3a%2019%20labels%3a%2020%20cis-app%3a%20%26%2334%3bapp%26%2334%3b%2021%20cis-port%3a%20%26%2334%3b443%26%2334%3b%2022%20name%3a%20app%2023spec%3a%2024%20ports%3a%2025%20-%20name%3a%20https%2026%20port%3a%20443%2027%20protocol%3a%20TCP%2028%20targetPort%3a%206443%20%e2%80%8b%09%e5%bd%93%e7%84%b6%e5%af%b9%e5%ba%94%e7%a7%81%e6%9c%89%e4%ba%91%e7%9a%84%e7%8e%af%e5%a2%83%ef%bc%8c%e4%b9%9f%e6%9c%89%20https%3a%2f%2fgithub." aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fexample.com%2fposts%2f2021%2f&t=2021" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
    <div id="toc">
      <nav id="TableOfContents"></nav>
    </div>
    
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        2021
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2022-03-06 18:34:11 &#43;0800 CST" itemprop="datePublished">2022-03-06</time>
          
        </div>
        
        
        <div class="article-read-time">
          <i class="far fa-clock"></i>
          
          16 minute read
        </div>
        
        
        
      </div>
    </header>

  
    
    <div class="content" itemprop="articleBody">
      <p>​	先说下CIS（Container Ingress Services）吧，也就是这个(<a href="https://github.com/F5Networks/k8s-bigip-ctlr">https://github.com/F5Networks/k8s-bigip-ctlr</a>) ，目的是为集群内的四层业务提供负载均衡，项目的初衷是为容器内的redis提供访问入口，毕竟pod的IP会变，之前是用Nginx ingress的四层stream做反向代理，那就要改configmap。（这里插一下redis在集群的模式是可以由一个入口进来，然后把流量转到 key 所在的 slot 所在的redis实例，也就是redis节点可以感知集群的其他节点。对于etcd？）由于各种原因开始测试这个CIS，网络那边还为此配置了 ECMP （https://en.wikipedia.org/wiki/Equal-cost_multi-path_routing），同时 ECMP 限制下一跳节点最多是16个，我们还为此搞出了Group到Namespace一对多的规划，每个Group计划流量大概40G吧😄。先说下这个CIS的奇葩之处吧，我们都知道根据Ingress的设计，最主要的是要找到Ingress对应的Service名字（名字在namespace级别是唯一的），根据名字来实现对应关系。但是CIS确是根据Service的label来关连的，而且CIS的对应关系是写在configmap里面，不支持多个configmap，也就是多个数组来表示不同的负载均衡。这里只是用ingress作为示例，表示我不是很赞同这个关系映射方式，因为你一个负载均衡的只需要知道Service名字，进而查出来bankend IP就好了，不应该在Service上面做事情。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#6272a4"># ingress 版 </span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#ff79c6">apiVersion</span>: extensions/v1beta1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span style="color:#ff79c6">kind</span>: Ingress
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#ff79c6">metadata</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>  <span style="color:#ff79c6">name</span>: app
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span style="color:#ff79c6">spec</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>  <span style="color:#ff79c6">rules</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>  - <span style="color:#ff79c6">host</span>: vsxen.github.io
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    <span style="color:#ff79c6">http</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>      <span style="color:#ff79c6">paths</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>      - <span style="color:#ff79c6">backend</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>          <span style="color:#ff79c6">serviceName</span>: nginx
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>          <span style="color:#ff79c6">servicePort</span>: <span style="color:#bd93f9">80</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>---
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4"># CIS版</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#ff79c6">apiVersion</span>: v1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#ff79c6">kind</span>: Service
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#ff79c6">metadata</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>  <span style="color:#ff79c6">labels</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>    <span style="color:#ff79c6">cis-app</span>: <span style="color:#f1fa8c">&#34;app&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>    <span style="color:#ff79c6">cis-port</span>: <span style="color:#f1fa8c">&#34;443&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>  <span style="color:#ff79c6">name</span>: app
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span style="color:#ff79c6">spec</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>  <span style="color:#ff79c6">ports</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>  - <span style="color:#ff79c6">name</span>: https
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span>    <span style="color:#ff79c6">port</span>: <span style="color:#bd93f9">443</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span>    <span style="color:#ff79c6">protocol</span>: TCP
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span>    <span style="color:#ff79c6">targetPort</span>: <span style="color:#bd93f9">6443</span>
</code></pre></div><p>​		当然对应私有云的环境，也有 <a href="https://github.com/metallb/metallb">https://github.com/metallb/metallb</a> 或者 青云的 <a href="https://github.com/openelb/openelb">https://github.com/openelb/openelb</a> 开源的解决档案，后者应该最近（12月26日）加入了cncf，这两种应该都是类似公有云，通过注解的方式来判断是否需要负载均衡，进而修改Service的Status字段，在我看来比较符合k8s的使用习惯，当然如果你使用calico的话，这里还有一个问题，一个节点上面只能和一个交换机建立一个连接，也就是会冲突，metallb也提供了一些方案。最后值得一提的Cilium也在1.10版本集成了metallb，也就是gobgp。最终这个项目还是不了了之了，愧对我之前说要在年后（3月）完成的承诺，也失去了这一次写代码的机会。我是计划使用go template的方式来渲染configmap的内容，嗯，也让我觉得很丑。</p>
<p>​		对于calico我也曾想试图学习一下网络，学习一下bgp，什么CLOS、VRF、大二层之类的，最终却都是纸上谈兵。不过还是研究了一下cni相关的流程（以下图表是用mermaid绘制），后来发现calico在Cisco的帮助下，支持了DPDK，也安装尝新了一下，更多的资源可以看这里。（https://www.yuque.com/wei.luo）</p>
<p><img src="content/assets/image-20211226180705656.png" alt="image-20211226180705656"></p>
<p>​		之后就是测试了containerd以及kata相关，一方面k8s官方宣布废弃docker，而且docker的守护进程和容器的生命周期强绑定（虽然可以配置live reload），于是就准备试试containerd。不过containerd就没有docker cli那么顺手，另外cadvisor对与containerd的监控指标有缺失，比如 <code>container_fs</code> 开头的所有指标（详见 <a href="https://cloud.google.com/kubernetes-engine/docs/concepts/using-containerd#known_issues">https://cloud.google.com/kubernetes-engine/docs/concepts/using-containerd#known_issues</a>）。这里插一下早期的 cadvisor 是通过读<code>/sys/fs/cgroup</code>下面的文件来监控容器的，后来看了下，metricsbeat也提到了这一点，Google Cloud也指出他们不受此影响，支持containerd 运行时监控。kata本来准备测试的2.x的版本，不过那时候才开始开发，安装之后报错了，就转向了1.12的版本，最大的好处是全都是静态编译，不会影响宿主机的环境，当然也没有做什么深入的测试，仅是配置了Runtime class，不幸的是对于aws开源的firecracker的测试没有成功。kata使用的vmlinux（kernel）是自定义的一个内核。</p>
<p>​		另外一个值得分享的就是qemu，虽然我至今不能解释qemu和kvm之间的联系，但是我成功的在vm上面使用qemu-x86跑了一个虚拟机，即嵌套虚拟化（kata当前版本并不支持），当然性能差极了，也试着用libvirt这个工具创建虚拟机。还有一个比较乌龙的就是我发现启动的vm不能ping通，就认为网络有问题，结果是ping也是要有权限才可以ping的。</p>
<p>​		接着就是粗略的看了下 Nginx Ingress 相关代码，主要是关于何时重载Nginx配置，是否对现有的连接产生影响，官方的文档这里有介绍 <a href="https://kubernetes.github.io/ingress-nginx/how-it-works/#avoiding-reloads">https://kubernetes.github.io/ingress-nginx/how-it-works/#avoiding-reloads</a> ，我发现的是这里https://github.com/kubernetes/ingress-nginx/blob/nginx-0.30.0/internal/ingress/controller/nginx.go#L865 ，所以可以说Nginx Ingress，在endpoint发生变化的时候，不会重载，在有新的Ingress或者证书之类配置才会重载（这里介绍相关平滑升级的原理）。</p>
<p>​		然后就看了下kube-healthy，因为k8s作为一个Paas平台，不像虚拟机那样，和应用有着很紧密的联系，比如CoreDNS挂了，或者是容器运行时出问题，CNI出问题等等，都会导致应用收到影响，而kube-healthy就是通过定时创建容器，或者探测DNS是否能正常响应，来实现动态的探测集群。另一方面，我想的是在集群中部署一个最简单的nginx，来确保Ingress进来的流量路径是没有问题的。但是根据阿里云某位大佬分享的文章  <a href="http://www.calmkart.com/?p=561">http://www.calmkart.com/?p=561</a>  kube-healthy 也存在一定的问题，比如说结果的上报是依赖于IP，就遇到过flannel网络下，服务端收到的请求来源 IP 非 Pod IP，而是所在节点 flannel.1 的 IP，应该是MASQ的问题，不过没时间深入研究，直接重置了flannel，（这里也有写 <a href="https://github.com/opsnull/kubernetes-troubleshooting-book">https://github.com/opsnull/kubernetes-troubleshooting-book</a>）。当我在写本文的时候发现了一个新的项目，https://github.com/erda-project/kubeprober/blob/master/README_CN.md，看样子也是类似的功能。除此之外官方还有一个npd的项目，通过读取docker和kernel的日志，记录到event中。</p>
<p>​		之后又测试了某厂商的一个流量分析的工具，这个主要是对TCP重传、丢包等网络层的监控。之前也试过elastic开源的packetbeat，更注重的是对常用的中间件的协议解析，比如MySQL、Redis等。</p>
<p>​		然而k8s发布版本的脚本未曾停下，新版本已经发到1.22了，刚好有团队说想用istio那一套，就趁着这个机会一块测试下，同时prometheus的新版本也在ui加上了tsdb status，发现几个id都属于高基准数据，然后就优化了下。同时测试的还有Redhat 8，但是还是支持iptables，而且默认也不是cgroup v2。</p>
<p>​		中间还出过几次物理机宕机的故障，挂有nas的容器，运行一段时间之后所在的物理机就直接重启，问了下nas的服务端，反馈是没有问题，而且登录远控也没有硬件故障，这时就要用到kdump了，可以把重启前的现场dump下来。最终也只是把这个几个nas应用迁移到专用的虚拟机上了事，虽然他们和物理机是同一个内核版本。之后还有一个比较奇怪的问题，就是有个机器用ssh key有时候能登上，有时候又报的是key认证失败，但是节点都是能ping通的，于是就找同网段的机器进行ping，最后经过抓包发现是mac地址居然不同，原来是IP被复用了。</p>
<p>​		接着说一下遇到docker的bug吧，systemd-logind报错</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>Jan <span style="color:#bd93f9">30</span> 23:10:01systemd-logind: Failed to start session scope session-31688.scope: The maximum number of pending replies per connection has been reached
</code></pre></div><p><a href="https://github.com/lnykryn/systemd-rhel/issues/266">https://github.com/lnykryn/systemd-rhel/issues/266</a> ，需要执行systemdctl daemon-reload 命令。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>dockerd<span style="color:#ff79c6">[</span>9951<span style="color:#ff79c6">]</span>: <span style="color:#8be9fd;font-style:italic">time</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;2018-03-12T13:02:44+09:00&#34;</span> <span style="color:#8be9fd;font-style:italic">level</span><span style="color:#ff79c6">=</span>info <span style="color:#8be9fd;font-style:italic">msg</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;shim reaped&#34;</span> <span style="color:#8be9fd;font-style:italic">id</span><span style="color:#ff79c6">=</span>f24980703b5d13089200d6bd84bf4c8648a9d4216633e5da8ecd237f0ff6e0bb <span style="color:#8be9fd;font-style:italic">module</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;containerd/tasks&#34;</span>
</code></pre></div><p>这个还没有找到根因</p>
<p><a href="https://github.com/containerd/containerd/issues/4547">https://github.com/containerd/containerd/issues/4547</a></p>
<p>一个容器oom之后，containerd收到大量的oom消息，这个也没有找到根因，不过两个都和oom有关</p>

    </div>
  </article>

  
  






  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/posts">Writings</a></li>
         
          <li><a href="/tags">Tags</a></li>
         
          <li><a href="/about">About</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents"></nav>
    </div>
    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fexample.com%2fposts%2f2021%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fexample.com%2fposts%2f2021%2f&text=2021" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fexample.com%2fposts%2f2021%2f&title=2021" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fexample.com%2fposts%2f2021%2f&is_video=false&description=2021" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=2021&body=Check out this article: https%3a%2f%2fexample.com%2fposts%2f2021%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fexample.com%2fposts%2f2021%2f&title=2021" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fexample.com%2fposts%2f2021%2f&title=2021" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fexample.com%2fposts%2f2021%2f&name=2021&description=%e2%80%8b%09%e5%85%88%e8%af%b4%e4%b8%8bCIS%ef%bc%88Container%20Ingress%20Services%ef%bc%89%e5%90%a7%ef%bc%8c%e4%b9%9f%e5%b0%b1%e6%98%af%e8%bf%99%e4%b8%aa%28https%3a%2f%2fgithub.com%2fF5Networks%2fk8s-bigip-ctlr%29%20%ef%bc%8c%e7%9b%ae%e7%9a%84%e6%98%af%e4%b8%ba%e9%9b%86%e7%be%a4%e5%86%85%e7%9a%84%e5%9b%9b%e5%b1%82%e4%b8%9a%e5%8a%a1%e6%8f%90%e4%be%9b%e8%b4%9f%e8%bd%bd%e5%9d%87%e8%a1%a1%ef%bc%8c%e9%a1%b9%e7%9b%ae%e7%9a%84%e5%88%9d%e8%a1%b7%e6%98%af%e4%b8%ba%e5%ae%b9%e5%99%a8%e5%86%85%e7%9a%84redis%e6%8f%90%e4%be%9b%e8%ae%bf%e9%97%ae%e5%85%a5%e5%8f%a3%ef%bc%8c%e6%af%95%e7%ab%9fpod%e7%9a%84IP%e4%bc%9a%e5%8f%98%ef%bc%8c%e4%b9%8b%e5%89%8d%e6%98%af%e7%94%a8Nginx%20ingress%e7%9a%84%e5%9b%9b%e5%b1%82stream%e5%81%9a%e5%8f%8d%e5%90%91%e4%bb%a3%e7%90%86%ef%bc%8c%e9%82%a3%e5%b0%b1%e8%a6%81%e6%94%b9configmap%e3%80%82%ef%bc%88%e8%bf%99%e9%87%8c%e6%8f%92%e4%b8%80%e4%b8%8bredis%e5%9c%a8%e9%9b%86%e7%be%a4%e7%9a%84%e6%a8%a1%e5%bc%8f%e6%98%af%e5%8f%af%e4%bb%a5%e7%94%b1%e4%b8%80%e4%b8%aa%e5%85%a5%e5%8f%a3%e8%bf%9b%e6%9d%a5%ef%bc%8c%e7%84%b6%e5%90%8e%e6%8a%8a%e6%b5%81%e9%87%8f%e8%bd%ac%e5%88%b0%20key%20%e6%89%80%e5%9c%a8%e7%9a%84%20slot%20%e6%89%80%e5%9c%a8%e7%9a%84redis%e5%ae%9e%e4%be%8b%ef%bc%8c%e4%b9%9f%e5%b0%b1%e6%98%afredis%e8%8a%82%e7%82%b9%e5%8f%af%e4%bb%a5%e6%84%9f%e7%9f%a5%e9%9b%86%e7%be%a4%e7%9a%84%e5%85%b6%e4%bb%96%e8%8a%82%e7%82%b9%e3%80%82%e5%af%b9%e4%ba%8eetcd%ef%bc%9f%ef%bc%89%e7%94%b1%e4%ba%8e%e5%90%84%e7%a7%8d%e5%8e%9f%e5%9b%a0%e5%bc%80%e5%a7%8b%e6%b5%8b%e8%af%95%e8%bf%99%e4%b8%aaCIS%ef%bc%8c%e7%bd%91%e7%bb%9c%e9%82%a3%e8%be%b9%e8%bf%98%e4%b8%ba%e6%ad%a4%e9%85%8d%e7%bd%ae%e4%ba%86%20ECMP%20%ef%bc%88https%3a%2f%2fen.wikipedia.org%2fwiki%2fEqual-cost_multi-path_routing%ef%bc%89%ef%bc%8c%e5%90%8c%e6%97%b6%20ECMP%20%e9%99%90%e5%88%b6%e4%b8%8b%e4%b8%80%e8%b7%b3%e8%8a%82%e7%82%b9%e6%9c%80%e5%a4%9a%e6%98%af16%e4%b8%aa%ef%bc%8c%e6%88%91%e4%bb%ac%e8%bf%98%e4%b8%ba%e6%ad%a4%e6%90%9e%e5%87%ba%e4%ba%86Group%e5%88%b0Namespace%e4%b8%80%e5%af%b9%e5%a4%9a%e7%9a%84%e8%a7%84%e5%88%92%ef%bc%8c%e6%af%8f%e4%b8%aaGroup%e8%ae%a1%e5%88%92%e6%b5%81%e9%87%8f%e5%a4%a7%e6%a6%8240G%e5%90%a7%f0%9f%98%84%e3%80%82%e5%85%88%e8%af%b4%e4%b8%8b%e8%bf%99%e4%b8%aaCIS%e7%9a%84%e5%a5%87%e8%91%a9%e4%b9%8b%e5%a4%84%e5%90%a7%ef%bc%8c%e6%88%91%e4%bb%ac%e9%83%bd%e7%9f%a5%e9%81%93%e6%a0%b9%e6%8d%aeIngress%e7%9a%84%e8%ae%be%e8%ae%a1%ef%bc%8c%e6%9c%80%e4%b8%bb%e8%a6%81%e7%9a%84%e6%98%af%e8%a6%81%e6%89%be%e5%88%b0Ingress%e5%af%b9%e5%ba%94%e7%9a%84Service%e5%90%8d%e5%ad%97%ef%bc%88%e5%90%8d%e5%ad%97%e5%9c%a8namespace%e7%ba%a7%e5%88%ab%e6%98%af%e5%94%af%e4%b8%80%e7%9a%84%ef%bc%89%ef%bc%8c%e6%a0%b9%e6%8d%ae%e5%90%8d%e5%ad%97%e6%9d%a5%e5%ae%9e%e7%8e%b0%e5%af%b9%e5%ba%94%e5%85%b3%e7%b3%bb%e3%80%82%e4%bd%86%e6%98%afCIS%e7%a1%ae%e6%98%af%e6%a0%b9%e6%8d%aeService%e7%9a%84label%e6%9d%a5%e5%85%b3%e8%bf%9e%e7%9a%84%ef%bc%8c%e8%80%8c%e4%b8%94CIS%e7%9a%84%e5%af%b9%e5%ba%94%e5%85%b3%e7%b3%bb%e6%98%af%e5%86%99%e5%9c%a8configmap%e9%87%8c%e9%9d%a2%ef%bc%8c%e4%b8%8d%e6%94%af%e6%8c%81%e5%a4%9a%e4%b8%aaconfigmap%ef%bc%8c%e4%b9%9f%e5%b0%b1%e6%98%af%e5%a4%9a%e4%b8%aa%e6%95%b0%e7%bb%84%e6%9d%a5%e8%a1%a8%e7%a4%ba%e4%b8%8d%e5%90%8c%e7%9a%84%e8%b4%9f%e8%bd%bd%e5%9d%87%e8%a1%a1%e3%80%82%e8%bf%99%e9%87%8c%e5%8f%aa%e6%98%af%e7%94%a8ingress%e4%bd%9c%e4%b8%ba%e7%a4%ba%e4%be%8b%ef%bc%8c%e8%a1%a8%e7%a4%ba%e6%88%91%e4%b8%8d%e6%98%af%e5%be%88%e8%b5%9e%e5%90%8c%e8%bf%99%e4%b8%aa%e5%85%b3%e7%b3%bb%e6%98%a0%e5%b0%84%e6%96%b9%e5%bc%8f%ef%bc%8c%e5%9b%a0%e4%b8%ba%e4%bd%a0%e4%b8%80%e4%b8%aa%e8%b4%9f%e8%bd%bd%e5%9d%87%e8%a1%a1%e7%9a%84%e5%8f%aa%e9%9c%80%e8%a6%81%e7%9f%a5%e9%81%93Service%e5%90%8d%e5%ad%97%ef%bc%8c%e8%bf%9b%e8%80%8c%e6%9f%a5%e5%87%ba%e6%9d%a5bankend%20IP%e5%b0%b1%e5%a5%bd%e4%ba%86%ef%bc%8c%e4%b8%8d%e5%ba%94%e8%af%a5%e5%9c%a8Service%e4%b8%8a%e9%9d%a2%e5%81%9a%e4%ba%8b%e6%83%85%e3%80%82%0a1%23%20ingress%20%e7%89%88%20%202apiVersion%3a%20extensions%2fv1beta1%203kind%3a%20Ingress%204metadata%3a%205%20name%3a%20app%206spec%3a%207%20rules%3a%208%20-%20host%3a%20vsxen.github.io%209%20http%3a%2010%20paths%3a%2011%20-%20backend%3a%2012%20serviceName%3a%20nginx%2013%20servicePort%3a%2080%2014---%2015%23%20CIS%e7%89%88%2016apiVersion%3a%20v1%2017kind%3a%20Service%2018metadata%3a%2019%20labels%3a%2020%20cis-app%3a%20%26%2334%3bapp%26%2334%3b%2021%20cis-port%3a%20%26%2334%3b443%26%2334%3b%2022%20name%3a%20app%2023spec%3a%2024%20ports%3a%2025%20-%20name%3a%20https%2026%20port%3a%20443%2027%20protocol%3a%20TCP%2028%20targetPort%3a%206443%20%e2%80%8b%09%e5%bd%93%e7%84%b6%e5%af%b9%e5%ba%94%e7%a7%81%e6%9c%89%e4%ba%91%e7%9a%84%e7%8e%af%e5%a2%83%ef%bc%8c%e4%b9%9f%e6%9c%89%20https%3a%2f%2fgithub." aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fexample.com%2fposts%2f2021%2f&t=2021" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2025  You 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Writings</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>

<script src=/js/code-copy.js></script>




</html>
